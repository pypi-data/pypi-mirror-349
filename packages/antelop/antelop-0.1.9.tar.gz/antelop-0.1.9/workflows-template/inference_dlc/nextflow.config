profiles {

    standard {

        includeConfig '../antelope-nf.config'

        process {
            withName: QueryData {
                container = 'antelope-python.sif'
                clusterOptions = '-c 1 -t 20 -p cpu'
                errorStrategy = {
                    sleep( task.attempt * 150 as long )
                    return 'retry'
                }
                maxRetries = 1
            }
        }
        process {
            withName: DownloadData {
                container = 'antelope-python.sif'
                clusterOptions = '-c 1 -t 30 -p cpu'
                errorStrategy = { (task.attempt <= 2) ? 'retry' : 'ignore' }
                }
        }
        process {
            withName: RunInference {
                container = 'dlc.sif'
                clusterOptions = '-p gpu -t 120 --gpus=1 --mem=31G'
                errorStrategy = { (task.attempt <= 2) ? 'retry' : 'ignore' }
                }
        }
        process {
            withName: UploadResults {
                container = 'antelope-python.sif'
                clusterOptions = '-c 1 -t 20 -p cpu'
                errorStrategy = { (task.attempt <= 2) ? 'retry' : 'ignore' }
                }
        }
  }
}
