profiles {

    standard {

        includeConfig '../antelop-nf.config'

        process {
            withName: DownloadData {
                container = 'antelop-python.sif'
                clusterOptions = '-c 1 -t 20 -p cpu'
                errorStrategy = {
                    sleep( task.attempt * 150 as long )
                    return 'retry'
                }
                maxRetries = 1
            }
        }
        process {
            withName: TrainModel {
                container = 'dlc.sif'
                clusterOptions = '-p gpu -t 60 --gpus=1 --mem=31G'
                errorStrategy = { (task.attempt <= 2) ? 'retry' : 'ignore' }
                }
        }
        process {
            withName: UploadModel {
                container = 'antelop-python.sif'
                clusterOptions = '-c 1 -t 20 -p cpu'
                errorStrategy = { (task.attempt <= 2) ? 'retry' : 'ignore' }
                }
        }
  }
}
