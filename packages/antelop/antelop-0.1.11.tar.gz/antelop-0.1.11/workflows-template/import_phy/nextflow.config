profiles {

    standard {

        includeConfig '../antelop-nf.config'

        process {
            withName: DownloadData {
                container = 'antelop-python.sif'
                clusterOptions = '-c 1 -t 20 -p cpu'
                errorStrategy = {
                    sleep( task.attempt * 150 as long )
                    return 'retry'
                    }
                maxRetries = 1
                }
        }

        process {
            withName: ConvertRec {
                container = 'spikeinterface.sif'
                clusterOptions = '-c 1 -t 60 -p cpu --mem=20G'
                errorStrategy = { (task.attempt <= 2) ? 'retry' : 'ignore' }
                }
        }

        process {
            withName: PreProcess {
                container = 'spikeinterface.sif'
                clusterOptions = '-c 1 -t 20 -p cpu --mem=10G'
                errorStrategy = { (task.attempt <= 2) ? 'retry' : 'ignore' }
                }
        }

        process {
            withName: ImportPhy {
                container = 'spikeinterface.sif'
                clusterOptions = '-c 1 -t 20 -p cpu --mem=20G'
                errorStrategy = { (task.attempt <= 2) ? 'retry' : 'ignore' }
                }
        }

        process {
            withName: ExtractWaveforms {
                container = 'spikeinterface.sif'
                clusterOptions = '-c 4 -t 30 -p cpu --mem=20G'
                errorStrategy = { (task.attempt <= 2) ? 'retry' : 'ignore' }
                }
        }

        process {
            withName: UploadData {
                container = 'antelop-python.sif'
                clusterOptions = '-c 2 -t 30 -p cpu --mem=10G'
                errorStrategy = { (task.attempt <= 2) ? 'retry' : 'ignore' }
                }
        }
    }
}
