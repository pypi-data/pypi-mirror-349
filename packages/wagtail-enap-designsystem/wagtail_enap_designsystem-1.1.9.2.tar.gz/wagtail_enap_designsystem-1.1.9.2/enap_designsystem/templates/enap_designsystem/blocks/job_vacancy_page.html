{% extends "enap_designsystem/base.html" %}
{% load wagtailcore_tags wagtailimages_tags %}

{% block content %}
<div class="job-vacancy-detail">
    <div class="header-container">
        <h1>{{ page.title }}</h1>
        <span class="job-tag {{ page.get_status_color }}">{{ page.get_status_label }}</span>
    </div>
    
    <div class="job-details">
        {% if page.process_code %}
        <div class="detail-item">
            <h3>Código do processo:</h3>
            <p>{{ page.process_code }}</p>
        </div>
        {% endif %}
        
        <div class="detail-item">
            <h3>Período de inscrição:</h3>
            <p>{{ registration_period }}</p>
        </div>
        
        <div class="detail-item">
            <h3>Descrição da vaga:</h3>
            <div class="rich-text">
                {{ page.full_description|richtext }}
            </div>
        </div>
        
        {% if page.inscription_link %}
        <div class="detail-item inscription-section">
            <h3>Inscrições:</h3>
            <a href="{{ page.inscription_link }}" class="btn btn-primary btn-lg" target="_blank">
                Inscrever-se
            </a>
        </div>
        {% endif %}
        
        {% if page.download_files %}
        <div class="detail-item">
            <h3>Arquivos para download:</h3>
            <div class="rich-text">
                {{ page.download_files|richtext }}
            </div>
        </div>
        {% endif %}
    </div>
    
    <div class="share-container">
        <button class="btn btn-outline share-btn" data-url="{{ share_url }}" onclick="shareJob(this)">
            <i class="icon-share"></i> Compartilhar
        </button>
    </div>
</div>

<script>
    function shareJob(button) {
        const url = button.getAttribute('data-url');
        
        if (navigator.share) {
            navigator.share({
                title: '{{ page.title }}',
                url: url
            }).catch(console.error);
        } else {
            // Fallback para navegadores que não suportam Web Share API
            navigator.clipboard.writeText(url).then(() => {
                const originalText = button.textContent;
                button.textContent = 'Link copiado!';
                setTimeout(() => {
                    button.innerHTML = '<i class="icon-share"></i> Compartilhar';
                }, 2000);
            });
        }
    }
</script>
{% endblock %}