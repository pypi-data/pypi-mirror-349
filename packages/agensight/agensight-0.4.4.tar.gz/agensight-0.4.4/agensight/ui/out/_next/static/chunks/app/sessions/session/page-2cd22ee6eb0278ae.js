(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[681],{285:(e,t,s)=>{"use strict";s.d(t,{$:()=>l});var r=s(5155);s(2115);var a=s(9708),n=s(2085),c=s(9434);let i=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all cursor-pointer disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function l(e){let{className:t,variant:s,size:n,asChild:l=!1,...o}=e,d=l?a.DX:"button";return(0,r.jsx)(d,{"data-slot":"button",className:(0,c.cn)(i({variant:s,size:n,className:t})),...o})}},6055:(e,t,s)=>{Promise.resolve().then(s.bind(s,9199))},6126:(e,t,s)=>{"use strict";s.d(t,{E:()=>i});var r=s(5155);s(2115);var a=s(2085),n=s(9434);let c=(0,a.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:s,...a}=e;return(0,r.jsx)("div",{className:(0,n.cn)(c({variant:s}),t),...a})}},7652:(e,t,s)=>{"use strict";s.d(t,{Dq:()=>i,Np:()=>l,_K:()=>c,_k:()=>o,um:()=>a,zi:()=>n});let r="http://0.0.0.0:5001/api";async function a(e){for(let t=1;t<=3;t++)try{let t=await fetch("".concat(r,"/traces/").concat(e,"/spans"));if(!t.ok){let e=await t.text();throw console.error("Error fetching trace: ".concat(t.status," ").concat(t.statusText),e),Error("Error fetching trace: ".concat(t.statusText))}return await t.json()}catch(s){if(console.error("Failed to fetch trace with ID ".concat(e," (attempt ").concat(t,"/").concat(3,"):"),s),3===t)throw s;await new Promise(e=>setTimeout(e,500*Math.pow(2,t-1)))}}async function n(e){for(let t=1;t<=3;t++)try{let t=await fetch("".concat(r,"/span/").concat(e,"/details"));if(!t.ok){let e=await t.text();throw console.error("Error fetching span details: ".concat(t.status," ").concat(t.statusText),e),Error("Error fetching span details: ".concat(t.statusText))}return await t.json()}catch(s){if(console.error("Failed to fetch span details with ID ".concat(e," (attempt ").concat(t,"/").concat(3,"):"),s),3===t)throw s;await new Promise(e=>setTimeout(e,500*Math.pow(2,t-1)))}throw Error("Failed to fetch span details")}async function c(){try{let e=await fetch("".concat(r,"/traces"));if(!e.ok)throw Error("Error fetching traces");return await e.json()}catch(e){throw console.log("Failed to fetch all traces:",e),e}}async function i(){try{let e=await fetch("".concat(r,"/sessions"));if(!e.ok)throw Error("Error fetching sessions: ".concat(e.statusText));return await e.json()}catch(e){throw console.error("Failed to fetch sessions:",e),e}}async function l(e){try{let t=await fetch("".concat(r,"/sessions/").concat(e,"/traces"));if(!t.ok)throw Error("Error fetching traces: ".concat(t.statusText));return await t.json()}catch(e){throw console.error("Failed to fetch traces:",e),e}}async function o(e){try{let t=await fetch("".concat(r,"/traces/").concat(e,"/spans"));if(!t.ok)throw Error("Error fetching spans: ".concat(t.statusText));return await t.json()}catch(e){throw console.error("Failed to fetch spans:",e),e}}},8643:(e,t,s)=>{"use strict";s.d(t,{Ke:()=>i,Nt:()=>n,R6:()=>c});var r=s(5155),a=s(8106);function n(e){let{...t}=e;return(0,r.jsx)(a.bL,{"data-slot":"collapsible",...t})}function c(e){let{...t}=e;return(0,r.jsx)(a.R6,{"data-slot":"collapsible-trigger",...t})}function i(e){let{...t}=e;return(0,r.jsx)(a.Ke,{"data-slot":"collapsible-content",...t})}},8856:(e,t,s)=>{"use strict";s.d(t,{E:()=>n});var r=s(5155),a=s(9434);function n(e){let{className:t,...s}=e;return(0,r.jsx)("div",{"data-slot":"skeleton",className:(0,a.cn)("bg-accent animate-pulse rounded-md",t),...s})}},9199:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>N});var r=s(5155),a=s(2115),n=s(5695),c=s(2960),i=s(7652),l=s(2355),o=s(4186),d=s(6474),x=s(4213),u=s(285),h=s(6126),m=s(8856),f=s(8643),p=s(6874),g=s.n(p);function b(){var e,t;let s=(0,n.useSearchParams)().get("sessionId"),{data:x,isLoading:m,error:p}=(0,c.I)({queryKey:["session-traces",s],queryFn:()=>s?(0,i.Np)(s):[],enabled:!!s}),[b,N]=a.useState([]),[y,k]=a.useState({}),z=a.useRef(null),E=a.useRef(null),_=e=>{k(t=>({...t,[e]:!t[e]}))};a.useEffect(()=>{x&&Array.isArray(x)&&(async()=>{N(await Promise.all(x.map(e=>(0,i._k)(e.id))))})()},[x]);let T=a.useMemo(()=>x&&Array.isArray(x)&&b.length===x.length?x.map((e,t)=>{let s=b[t];return Array.isArray(s)&&(s=void 0),{traceId:e.id,trace_input:(null==s?void 0:s.trace_input)||"",trace_output:(null==s?void 0:s.trace_output)||"",agents:(null==s?void 0:s.agents)||[],trace:e,timestamp:e.started_at||0}}).sort((e,t)=>e.timestamp-t.timestamp):[],[x,b]),A=a.useCallback(e=>{if(E.current){let t=e.currentTarget.scrollTop/(e.currentTarget.scrollHeight-e.currentTarget.clientHeight)*(E.current.scrollHeight-E.current.clientHeight);E.current.scrollTop=t}},[]),I=a.useCallback(e=>{if(z.current){let t=e.currentTarget.scrollTop/(e.currentTarget.scrollHeight-e.currentTarget.clientHeight)*(z.current.scrollHeight-z.current.clientHeight);z.current.scrollTop=t}},[]);return m?(0,r.jsx)(v,{}):p?(0,r.jsx)(j,{}):T.length?(0,r.jsxs)("div",{className:"flex flex-col w-full h-screen bg-zinc-50 dark:bg-zinc-900",children:[(0,r.jsx)("header",{className:"sticky top-0 z-10 w-full bg-white dark:bg-zinc-950 border-b border-zinc-200 dark:border-zinc-800 px-3 py-2",children:(0,r.jsxs)("div",{className:"flex items-center justify-between max-w-screen-2xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(u.$,{variant:"ghost",size:"icon",className:"h-7 w-7",asChild:!0,children:(0,r.jsxs)(g(),{href:"/sessions",children:[(0,r.jsx)(l.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Back"})]})}),(0,r.jsx)("h1",{className:"text-sm font-semibold",children:"Session Viewer"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(h.E,{variant:"outline",className:"font-mono text-xs h-5 px-1.5",children:[null==s?void 0:s.substring(0,8),"..."]}),(0,r.jsxs)(h.E,{variant:"secondary",className:"text-xs h-5 px-1.5",children:[(0,r.jsx)(o.A,{className:"mr-1 h-3 w-3"}),(null==(t=T[0])||null==(e=t.trace)?void 0:e.started_at)?new Date(1e3*T[0].trace.started_at).toLocaleTimeString():"N/A"]})]})]})}),(0,r.jsx)("div",{className:"flex-1 overflow-hidden max-w-screen-2xl w-full mx-auto",children:(0,r.jsxs)("div",{className:"flex h-[calc(100vh-3rem)]",children:[(0,r.jsx)("div",{className:"w-[65%] border-r border-zinc-200 dark:border-zinc-800",children:(0,r.jsx)("div",{className:"h-full overflow-y-auto",ref:z,onScroll:A,children:(0,r.jsx)("div",{className:"p-3 space-y-4",children:T.map((e,t)=>{var s,a;return(0,r.jsxs)("div",{className:"relative pb-4",id:"trace-".concat(e.traceId),children:[(0,r.jsxs)(h.E,{variant:"outline",className:"absolute left-0 top-0 font-mono text-xs px-1.5 bg-zinc-100 dark:bg-zinc-800 rounded-md",children:["Trace ID: ",e.traceId]}),(0,r.jsxs)("div",{className:"flex flex-col items-end space-y-1 mb-3 mt-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("span",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:"User"}),(0,r.jsx)("div",{className:"h-5 w-5 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-blue-600 dark:text-blue-300 text-xs font-medium",children:"U"})})]}),(0,r.jsx)("div",{className:"bg-blue-500 text-white px-3 py-2 rounded-xl rounded-tr-none max-w-[90%]",children:(0,r.jsx)("p",{className:"whitespace-pre-line text-xs",children:e.trace_input})}),(0,r.jsx)("span",{className:"text-[10px] text-zinc-500 dark:text-zinc-400",children:(null==(s=e.trace)?void 0:s.started_at)?new Date(1e3*e.trace.started_at).toLocaleTimeString():""})]}),e.trace_output&&(0,r.jsxs)("div",{className:"flex flex-col items-start space-y-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("div",{className:"h-5 w-5 rounded-full bg-purple-100 dark:bg-purple-900 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-purple-600 dark:text-purple-300 text-xs font-medium",children:"A"})}),(0,r.jsx)("span",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:"Assistant"})]}),(0,r.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-800 px-3 py-2 rounded-xl rounded-tl-none w-full max-w-[90%]",children:(0,r.jsx)("p",{className:"whitespace-pre-line text-xs",children:e.trace_output})}),(0,r.jsx)("span",{className:"text-[10px] text-zinc-500 dark:text-zinc-400",children:(null==(a=e.trace)?void 0:a.ended_at)?new Date(1e3*e.trace.ended_at).toLocaleTimeString():""})]}),t<T.length-1&&(0,r.jsx)("div",{className:"border-b border-dashed border-zinc-200 dark:border-zinc-800 mt-3"})]},e.traceId)})})})}),(0,r.jsx)("div",{className:"w-[35%] bg-zinc-50 dark:bg-zinc-900",children:(0,r.jsx)("div",{className:"h-full overflow-y-auto",ref:E,onScroll:I,children:(0,r.jsxs)("div",{className:"p-3",children:[(0,r.jsx)("div",{className:"text-xs font-medium mb-2 text-zinc-500 dark:text-zinc-400 border-b border-zinc-200 dark:border-zinc-800 pb-1",children:"Agent Details"}),T.map((e,t)=>{var s;return(0,r.jsxs)("div",{className:"mb-4",id:"details-".concat(e.traceId),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,r.jsxs)(h.E,{variant:"outline",className:"font-mono text-[10px] h-4 px-1",children:["Trace ID: ",e.traceId]}),(0,r.jsx)("span",{className:"text-[10px] text-zinc-500 dark:text-zinc-400",children:(null==(s=e.trace)?void 0:s.started_at)?new Date(1e3*e.trace.started_at).toLocaleTimeString():""})]}),e.agents&&e.agents.length>0?(0,r.jsxs)(f.Nt,{open:y[e.traceId],onOpenChange:()=>_(e.traceId),className:"w-full",children:[(0,r.jsx)(f.R6,{asChild:!0,children:(0,r.jsxs)(u.$,{variant:"ghost",size:"sm",className:"w-full h-6 px-2 text-xs justify-between mb-1 bg-white dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 rounded",children:[(0,r.jsxs)("span",{children:[e.agents.length," Agent",e.agents.length>1?"s":""]}),(0,r.jsx)(d.A,{className:"h-3 w-3 transition-transform ".concat(y[e.traceId]?"rotate-180":"")})]})}),(0,r.jsx)(f.Ke,{className:"space-y-2 mt-1",children:e.agents.map((e,t)=>(0,r.jsxs)("div",{className:"bg-white dark:bg-zinc-950 rounded border border-zinc-200 dark:border-zinc-800 p-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,r.jsxs)("span",{className:"text-[10px] font-medium",children:["Agent ",t+1]}),(0,r.jsx)(h.E,{variant:"outline",className:"text-[10px] h-4 px-1",children:e.model||"Unknown"})]}),(0,r.jsxs)("div",{className:"text-[10px] text-zinc-500 dark:text-zinc-400 mb-1",children:["Tokens: ",e.tokens||"N/A"]}),(0,r.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 rounded p-1 max-h-[80px] overflow-y-auto",children:(0,r.jsx)("p",{className:"text-[10px] whitespace-pre-line",children:e.final_completion})})]},e.span_id||t))})]}):(0,r.jsx)("div",{className:"text-[10px] text-zinc-500 dark:text-zinc-400 italic",children:"No agent data available"}),t<T.length-1&&(0,r.jsx)("div",{className:"border-b border-dashed border-zinc-200 dark:border-zinc-800 mt-2"})]},"details-".concat(e.traceId))})]})})})]})})]}):(0,r.jsx)(w,{})}function v(){return(0,r.jsx)("div",{className:"flex flex-col items-center justify-center h-screen p-4",children:(0,r.jsxs)("div",{className:"w-full max-w-md space-y-4",children:[(0,r.jsx)(m.E,{className:"h-6 w-3/4 mx-auto"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(m.E,{className:"h-16 w-full"}),(0,r.jsx)(m.E,{className:"h-16 w-full"}),(0,r.jsx)(m.E,{className:"h-16 w-full"})]})]})})}function j(){return(0,r.jsx)("div",{className:"flex flex-col items-center justify-center h-screen p-4",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-red-500 mb-2",children:"Error Loading Traces"}),(0,r.jsx)("p",{className:"text-sm text-zinc-600 dark:text-zinc-400 mb-4",children:"There was a problem loading the session data. Please try again."}),(0,r.jsx)(u.$,{asChild:!0,size:"sm",children:(0,r.jsx)(g(),{href:"/sessions",children:"Return to Sessions"})})]})})}function w(){return(0,r.jsx)("div",{className:"flex flex-col items-center justify-center h-screen p-4",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(x.A,{className:"h-10 w-10 text-zinc-400 mx-auto mb-3"}),(0,r.jsx)("h2",{className:"text-xl font-bold mb-2",children:"No Conversation Data"}),(0,r.jsx)("p",{className:"text-sm text-zinc-600 dark:text-zinc-400 mb-4",children:"There are no traces available for this session."}),(0,r.jsx)(u.$,{asChild:!0,size:"sm",children:(0,r.jsx)(g(),{href:"/sessions",children:"Return to Sessions"})})]})})}function N(){return(0,r.jsx)(a.Suspense,{fallback:(0,r.jsx)(v,{}),children:(0,r.jsx)(b,{})})}},9434:(e,t,s)=>{"use strict";s.d(t,{cn:()=>n});var r=s(2596),a=s(9688);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.QP)((0,r.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[126,967,406,325,441,684,358],()=>t(6055)),_N_E=e.O()}]);