import{v as u,a as N,b as K,w as E}from"./runtime-dom.esm-bundler.DChKj6X8.js";import{c as j}from"./deployments.BsnUMWKT.js";/* empty css                     */import{_ as L}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{d as G,c as s,a as n,b as a,w as l,e as f,F as y,f as H,t as O,r as o,g as z,h as r}from"./runtime-core.esm-bundler.Y6RLDZTT.js";import"./user.DMXaCJik.js";import"./user.TOXT8CXA.js";import"./index.BSdFiPHn.js";import"./loader.BQDlK3Tc.js";import"./notifications.NSMm1_5U.js";import"./index.CwJxcYEt.js";const J=G({__name:"DeploymentForm",props:{supported:{},deployment:{},kubernetes:{type:Boolean}},setup(x,{expose:e}){e();const g=x,{supported:i,deployment:T,kubernetes:D}=O(g);function t(p){return i.value.includes(p)}const m=o(""),d=o(""),I=o(""),U=o("main"),q=o(""),M=o(""),R=o(""),W=o("default"),b=o("ghcr.io/rebound-how/reliably-job:latest"),k=o(!0),C=o(""),V=o(!1),v=o(""),w=o("manual"),B=o(""),S=o(""),P=o(""),A=z(()=>d.value===""?!0:d.value==="github"?m.value===""||I.value===""||U.value===""||q.value===""||M.value==="":d.value==="container"?m.value===""||R.value==="":d.value==="reliably_cloud"||d.value==="reliably_cli"?m.value==="":d.value==="kubernetes"?m.value===""||W.value===""||b.value===""||D.value===!1&&k.value===!1&&v.value===""||k.value===!1&&C.value===""||V.value===!1&&v.value==="":!0),F={props:g,supported:i,deployment:T,kubernetes:D,supports:t,deploymentName:m,definitionType:d,definitionRepo:I,definitionBranch:U,definitionUsername:q,definitionToken:M,definitionImageName:R,definitionK8sNamespace:W,definitionK8sImage:b,definitionK8sUseDefaultManifest:k,definitionK8sManifest:C,definitionK8sUseInClusterCredentials:V,definitionK8sCredentials:v,definitionCliRunMode:w,definitionBaseDir:B,definitionPyVer:S,definitionInstallDeps:P,isSubmitDisabled:A,proceed:async()=>{let p={name:m.value,definition:{type:d.value}};d.value==="github"?p.definition={type:d.value,repo:I.value,branch:U.value,username:q.value,token:M.value}:d.value==="container"?p.definition={type:d.value,image:R.value}:d.value==="kubernetes"?(p.definition={type:"k8s_job",namespace:W.value,use_default_manifest:k.value,use_in_cluster_credentials:V.value},b.value!==""&&(p.definition.image=b.value),C.value!==""&&(p.definition.manifest=C.value),v.value!==""&&(p.definition.credentials=v.value)):d.value==="reliably_cli"&&(p.definition={type:d.value,mode:w.value,base_dir:B.value||null,py_version:S.value||null,py_dependencies:P.value||null}),await j(p)}};return Object.defineProperty(F,"__isScriptSetup",{enumerable:!1,value:!0}),F}}),Q={class:"deploymentForm form"},X={class:"inputWrapper"},Y={class:"inputWrapper"},Z={key:0,value:"reliably_cloud"},_={key:1,value:"reliably_cli"},c={key:2,value:"container"},h={key:3,value:"github"},$={key:4,value:"kubernetes"},ee={class:"inputWrapper"},ne={class:"inputWrapper"},ie={class:"inputWrapper"},te={class:"inputWrapper"},le={class:"inputWrapper"},oe={class:"inputWrapper"},se={class:"inputWrapper"},ae={class:"inputWrapper"},re={key:2,class:"inputWrapper"},de={class:"inputWrapper"},ue={class:"inputWrapper"},pe={class:"inputWrapper inputWrapper--tick","aria-labelledby":"definitionK8sDefaultManifest"},fe={key:0,class:"inputWrapper"},me={key:1,class:"inputWrapper inputWrapper--tick","aria-labelledby":"definitionK8sInClusterCredentials"},ye={key:2,class:"inputWrapper"},ve={class:"inputWrapper"},be=["disabled"];function ke(x,e,g,i,T,D){return r(),s("form",Q,[n("fieldset",null,[e[21]||(e[21]=n("legend",null,"Deployment",-1)),n("div",X,[e[20]||(e[20]=n("label",{for:"deploymentName"},[a(" Deployment name "),n("span",{class:"required"},"Required")],-1)),l(n("input",{type:"text",name:"deploymentName",id:"deploymentName","onUpdate:modelValue":e[0]||(e[0]=t=>i.deploymentName=t),required:""},null,512),[[u,i.deploymentName]])])]),n("fieldset",null,[e[59]||(e[59]=n("legend",null,"Definition",-1)),n("div",Y,[e[23]||(e[23]=n("label",{for:"type"},[a("Type "),n("span",{class:"required"},"Required")],-1)),l(n("select",{name:"type",id:"type","onUpdate:modelValue":e[1]||(e[1]=t=>i.definitionType=t),required:""},[e[22]||(e[22]=n("option",{value:""},"Select deployment type",-1)),i.supports("cloud")?(r(),s("option",Z," Reliably Cloud ")):f("",!0),i.supports("cli")?(r(),s("option",_," Reliably CLI ")):f("",!0),i.supports("docker")?(r(),s("option",c,"Docker")):f("",!0),i.supports("github")?(r(),s("option",h,"GitHub")):f("",!0),i.supports("kubernetes")?(r(),s("option",$," Kubernetes ")):f("",!0)],512),[[N,i.definitionType]])]),i.definitionType==="reliably_cli"?(r(),s(y,{key:0},[n("div",ee,[e[25]||(e[25]=n("label",{for:"deploymentCliRunMode"},"Execution Mode",-1)),l(n("select",{name:"runMode",id:"runMode","onUpdate:modelValue":e[2]||(e[2]=t=>i.definitionCliRunMode=t),required:""},e[24]||(e[24]=[n("option",{value:"manual"},"Manual",-1),n("option",{value:"managed"},"Managed",-1)]),512),[[N,i.definitionCliRunMode]]),e[26]||(e[26]=n("p",{class:"inputWrapper__help"},[a(" In "),n("strong",null,"manual"),a(" mode, Reliably will prepare and schedule a plan but you be responsible to execute it with the CLI at your own convenience. In "),n("strong",null,"managed"),a(" mode, Reliably will launch the plan for you immediately or as per its schedule. ")],-1))]),i.definitionCliRunMode=="managed"?(r(),s(y,{key:0},[n("div",ne,[e[27]||(e[27]=n("label",{for:"deploymentBaseDir"}," Execution Directory ",-1)),l(n("input",{type:"string",name:"deploymentBaseDir",id:"deploymentBaseDir","onUpdate:modelValue":e[3]||(e[3]=t=>i.definitionBaseDir=t)},null,512),[[u,i.definitionBaseDir]]),e[28]||(e[28]=n("p",{class:"inputWrapper__help"}," Absolute directory where to move to first. This directory must exist. If not set, a temporary directory will be created when a plan runs ",-1))]),n("div",ie,[e[30]||(e[30]=n("label",{for:"deploymentBaseDir"}," Python Environment ",-1)),l(n("select",{name:"pythonVer",id:"pythonVer","onUpdate:modelValue":e[4]||(e[4]=t=>i.definitionPyVer=t)},e[29]||(e[29]=[H('<option value="" data-v-3c73c188>Select a python version to install</option><option value="3.11" data-v-3c73c188>3.11</option><option value="3.12" data-v-3c73c188>3.12</option><option value="3.13" data-v-3c73c188>3.13</option><option value="3.14" data-v-3c73c188>3.14</option>',5)]),512),[[N,i.definitionPyVer]]),e[31]||(e[31]=n("p",{class:"inputWrapper__help"}," Download an install a specific Python version to run the plan. If not set, use the system Python ",-1))]),n("div",te,[e[32]||(e[32]=n("label",{for:"deploymentInstallDeps"}," Execution Dependencies ",-1)),l(n("textarea",{name:"deploymentInstallDeps",id:"deploymentInstallDeps","onUpdate:modelValue":e[5]||(e[5]=t=>i.definitionInstallDeps=t),required:""},null,512),[[u,i.definitionInstallDeps]]),e[33]||(e[33]=n("p",{class:"inputWrapper__help"},[a(" Python dependencies to install on-the-fly. Set the content of a "),n("a",{href:"https://pip.pypa.io/en/stable/reference/requirements-file-format/"},"requirements.txt"),a(" file ")],-1))])],64)):f("",!0)],64)):i.definitionType==="github"?(r(),s(y,{key:1},[n("div",le,[e[34]||(e[34]=n("label",{for:"deploymentRepo"},[a(" Repository "),n("span",{class:"required"},"Required")],-1)),l(n("input",{type:"url",name:"deploymentRepo",id:"deploymentRepo","onUpdate:modelValue":e[6]||(e[6]=t=>i.definitionRepo=t),required:""},null,512),[[u,i.definitionRepo]]),e[35]||(e[35]=n("p",{class:"inputWrapper__help"},"A repository URL",-1))]),n("div",oe,[e[36]||(e[36]=n("label",{for:"deploymentBranch"},[a(" Branch "),n("span",{class:"required"},"Required")],-1)),l(n("input",{type:"text",name:"deploymentBranch",id:"deploymentBranch","onUpdate:modelValue":e[7]||(e[7]=t=>i.definitionBranch=t),required:""},null,512),[[u,i.definitionBranch]]),e[37]||(e[37]=n("p",{class:"inputWrapper__help"}," An existing branch in your target repository ",-1))]),n("div",se,[e[38]||(e[38]=n("label",{for:"deploymentUsername"},[a(" Username "),n("span",{class:"required"},"Required")],-1)),l(n("input",{type:"text",name:"deploymentUsername",id:"deploymentUsername","onUpdate:modelValue":e[8]||(e[8]=t=>i.definitionUsername=t),required:""},null,512),[[u,i.definitionUsername]]),e[39]||(e[39]=n("p",{class:"inputWrapper__help"}," A GitHub username with access to the repository ",-1))]),n("div",ae,[e[40]||(e[40]=n("label",{for:"deploymentToken"},[a(" Token "),n("span",{class:"required"},"Required")],-1)),l(n("input",{type:"text",name:"deploymentToken",id:"deploymentToken","onUpdate:modelValue":e[9]||(e[9]=t=>i.definitionToken=t),autocomplete:"off",required:""},null,512),[[u,i.definitionToken]]),e[41]||(e[41]=n("p",{class:"inputWrapper__help"}," A token granting access to the repository ",-1))])],64)):i.definitionType==="container"?(r(),s("div",re,[e[42]||(e[42]=n("label",{for:"dockerName"},[a(" Docker image name "),n("span",{class:"required"},"Required")],-1)),l(n("input",{type:"string",name:"dockerName",id:"dockerName","onUpdate:modelValue":e[10]||(e[10]=t=>i.definitionImageName=t),required:""},null,512),[[u,i.definitionImageName]]),e[43]||(e[43]=n("p",{class:"inputWrapper__help"}," The name of the Docker image this deployment will be targeting ",-1))])):i.definitionType==="kubernetes"?(r(),s(y,{key:3},[n("div",de,[e[44]||(e[44]=n("label",{for:"k8sNamespace"},[a(" Namespace "),n("span",{class:"required"},"Required")],-1)),l(n("input",{type:"string",name:"k8sNamespace",id:"k8sNamespace","onUpdate:modelValue":e[11]||(e[11]=t=>i.definitionK8sNamespace=t),placeholder:"default",required:""},null,512),[[u,i.definitionK8sNamespace]])]),n("div",ue,[e[45]||(e[45]=n("label",{for:"k8sImage"},[a(" Image "),n("span",{class:"required"},"Required")],-1)),l(n("input",{type:"string",name:"k8sImage",id:"k8sImage","onUpdate:modelValue":e[12]||(e[12]=t=>i.definitionK8sImage=t),placeholder:"ghcr.io/rebound-how/reliably-job:latest",required:""},null,512),[[u,i.definitionK8sImage]])]),n("div",pe,[e[48]||(e[48]=n("label",{id:"definitionK8sDefaultManifest"}," Use default manifest ",-1)),n("div",null,[l(n("input",{type:"radio",value:!0,"onUpdate:modelValue":e[13]||(e[13]=t=>i.definitionK8sUseDefaultManifest=t),id:"definitionK8sDefaultManifest-true",name:"definitionK8sDefaultManifest-true"},null,512),[[K,i.definitionK8sUseDefaultManifest]]),e[46]||(e[46]=n("label",{for:"definitionK8sDefaultManifest-true"},"True",-1))]),n("div",null,[l(n("input",{type:"radio",value:!1,"onUpdate:modelValue":e[14]||(e[14]=t=>i.definitionK8sUseDefaultManifest=t),id:"definitionK8sDefaultManifest-false",name:"definitionK8sDefaultManifest-false"},null,512),[[K,i.definitionK8sUseDefaultManifest]]),e[47]||(e[47]=n("label",{for:"definitionK8sDefaultManifest-false"},"False",-1))])]),i.definitionK8sUseDefaultManifest?f("",!0):(r(),s("div",fe,[e[49]||(e[49]=n("label",{for:"k8sManifest"},[a(" Manifest "),n("span",{class:"required"},"Required")],-1)),l(n("textarea",{name:"k8sManifest",id:"k8sManifest","onUpdate:modelValue":e[15]||(e[15]=t=>i.definitionK8sManifest=t),required:""},null,512),[[u,i.definitionK8sManifest]]),e[50]||(e[50]=n("p",{class:"inputWrapper__help"}," If you're not using the default manifest, paste your Kubernetes manifest here. ",-1))])),i.kubernetes?(r(),s("div",me,[e[53]||(e[53]=n("label",{id:"definitionK8sInClusterCredentials"}," Use in-cluster credentials ",-1)),e[54]||(e[54]=n("p",{class:"inputWrapper__help"}," If Reliably runs in your Kubernetes cluster, you can have it use the credentials from the cluster. ",-1)),n("div",null,[l(n("input",{type:"radio",value:!0,"onUpdate:modelValue":e[16]||(e[16]=t=>i.definitionK8sUseInClusterCredentials=t),id:"definitionK8sInClusterCredentials-true",name:"definitionK8sInClusterCredentials-true"},null,512),[[K,i.definitionK8sUseInClusterCredentials]]),e[51]||(e[51]=n("label",{for:"definitionK8sInClusterCredentials-true"},"True",-1))]),n("div",null,[l(n("input",{type:"radio",value:!1,"onUpdate:modelValue":e[17]||(e[17]=t=>i.definitionK8sUseInClusterCredentials=t),id:"definitionK8sInClusterCredentials-false",name:"definitionK8sInClusterCredentials-false"},null,512),[[K,i.definitionK8sUseInClusterCredentials]]),e[52]||(e[52]=n("label",{for:"definitionK8sInClusterCredentials-false"},"False",-1))])])):f("",!0),i.definitionK8sUseInClusterCredentials?f("",!0):(r(),s("div",ye,[i.deployment==="onprem"?(r(),s(y,{key:0},[e[55]||(e[55]=n("label",{for:"k8sCredentials"}," Credentials ",-1)),l(n("textarea",{name:"k8sCredentials",id:"k8sCredentials","onUpdate:modelValue":e[18]||(e[18]=t=>i.definitionK8sCredentials=t)},null,512),[[u,i.definitionK8sCredentials]]),e[56]||(e[56]=n("p",{class:"inputWrapper__help"}," If you don't want Reliably to use in-cluster credentials, you can provide credentials here. If no credentials are provided, the credentials from the machine running Reliably will be used. ",-1))],64)):(r(),s(y,{key:1},[e[57]||(e[57]=n("label",{for:"k8sCredentials"},[a(" Credentials "),n("span",{class:"required"},"Required")],-1)),l(n("textarea",{name:"k8sCredentials",id:"k8sCredentials","onUpdate:modelValue":e[19]||(e[19]=t=>i.definitionK8sCredentials=t),required:""},null,512),[[u,i.definitionK8sCredentials]]),e[58]||(e[58]=n("p",{class:"inputWrapper__help"}," If you don't want Reliably to use in-cluster credentials, you must provide credentials here. ",-1))],64))]))],64)):f("",!0),n("div",ve,[n("button",{onClick:E(i.proceed,["prevent"]),disabled:i.isSubmitDisabled,class:"button button--primary"}," Create deployment ",8,be)])])])}const xe=L(J,[["render",ke],["__scopeId","data-v-3c73c188"]]);export{xe as default};
