import{h as c}from"./user.BEEfOshe.js";import{o as m,m as h}from"./user.Bg1Nd46A.js";import{i as l,d as u}from"./loader.BQDlK3Tc.js";import{a as r}from"./notifications.NSMm1_5U.js";import{u as y}from"./index.CwJxcYEt.js";import{a as d}from"./index.BSdFiPHn.js";const w={ASSETS_PREFIX:void 0,BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,PUBLIC_API_URL:"/api",SITE:void 0,SSR:!1},i=w===void 0?"https://62ff903e9350a1e548e1952e.mockapi.io/api":"/api",I=i==="https://62ff903e9350a1e548e1952e.mockapi.io/api",E=I?"&limit=10":"",o=y(m),f=h({page:0,integrations:[],total:0,isReady:!1});async function $(n){return f.set(n),f.get()}const R=async n=>{l();const a=`${i}/organization/${o.value}/integrations?page=${n}${E}`;try{const e=await fetch(a);if(e.status===403)c(o.value);else if(e.ok){const t=await e.json();let s={page:n,integrations:t.items,total:t.count,isReady:!0};$(s)}else throw new Error(e.statusText)}catch(e){const t={title:"Integrations couldn't be fetched",message:e.message,type:"error"};r(t)}finally{u()}},z=async(n,a)=>{l();const e=`${i}/organization/${o.value}/integrations`;try{const t=await fetch(e,{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify(n)});if(t.status===403)c(o.value);else if(t.ok){const s=await t.json();if(a!==void 0&&a===!0)return s;window.location.assign("/integrations/")}else throw new Error(t.statusText)}catch(t){const s={title:"Integration couldn't be created",message:t.message,type:"error"};r(s)}finally{u()}},A=async n=>{l();let a=!0;const e=`${i}/organization/${o.value}/integrations/${n}`;try{const t=await fetch(e,{method:"DELETE"});if(t.status===403)c(o.value);else if(t.status===400){let s=await t.json();r({title:"Integration couldn't be deleted",message:"This integration is used by a plan. You must delete the plan before proceeding.",type:"error"}),a=!1}else if(!t.ok)throw new Error(t.statusText)}catch(t){const s={title:"Integration couldn't be deleted",message:t.message,type:"error"};r(s),a=!1}finally{return u(),a}},g=d(null);async function v(n){return g.set(n),g.get()}const L=async n=>{l();const a=`${i}/organization/${o.value}/integrations/${n}`;try{const e=await fetch(a);if(e.status===403)c(o.value);else if(e.ok){const t=await e.json();v(t)}else throw new Error(e.statusText)}catch(e){const t={title:"Integration couldn't be fetched",message:e.message,type:"error"};r(t)}finally{u()}},p=d(null);async function T(n){return p.set(n),p.get()}const P=async n=>{l();const a=`${i}/organization/${o.value}/integrations/${n}/control`;try{const e=await fetch(a);if(e.status===403)c(o.value);else if(e.ok){const t=await e.json();T(t)}else throw new Error(e.statusText)}catch(e){const t={title:"Control couldn't be fetched",message:e.message,type:"error"};r(t)}finally{u()}};export{P as a,f as b,z as c,A as d,L as e,R as f,g,p as i};
