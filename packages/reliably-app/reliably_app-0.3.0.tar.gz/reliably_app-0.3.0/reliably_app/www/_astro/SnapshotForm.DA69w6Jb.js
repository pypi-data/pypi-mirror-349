import{v as _,c as S,w as q}from"./runtime-dom.esm-bundler.DChKj6X8.js";import{c as H}from"./integrations.CUprebZ9.js";import{a as j,s as L,b as F,u as M}from"./snapshots.Bn5DFrP3.js";import{g as G}from"./strings.Fm4VVZpd.js";import{B as X}from"./ButtonLoader.DliJ452e.js";import{A as J}from"./AwsLogo.UvCYOLAB.js";import{G as z}from"./GoogleCloudLogo.D_PfFuNt.js";import{K as Q}from"./KubernetesLogoBlue.DW9q2K_R.js";import{G as Z}from"./GithubLogo.AFEE3hFH.js";/* empty css                           */import{_ as $}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{d as ee,c as m,a as e,b as V,w as l,i as y,e as f,n as se,r as a,g as te,o as ne,h as p}from"./runtime-core.esm-bundler.Y6RLDZTT.js";import"./user.BEEfOshe.js";import"./user.Bg1Nd46A.js";import"./index.BSdFiPHn.js";import"./loader.BQDlK3Tc.js";import"./notifications.NSMm1_5U.js";import"./index.CwJxcYEt.js";import"./dayjs.min.xlbmdZiw.js";import"./duration.BGVtNWJ9.js";const ae=ee({__name:"SnapshotForm",setup(N,{expose:s}){s();const C=a(""),t=a(!1),E=a(!1),g=a(!1),n=a(!1);function P(){let v=window.location,r=new URLSearchParams(v.search);if(r.has("template")){const u=r.get("template");u==="aws"?t.value:u==="gcp"?E.value:u==="kubernetes"&&g.value}}const U=a(!0),R=a(""),I=a(""),k=a(!0),O=a(""),T=a(""),x=a(""),K=a(!0),w=a(""),W=a(""),A=a(!1),Y=te(()=>!!(C.value===""||A.value));function h(){if(L.value!==null){const v=L.value;C.value=v.name;const r=v.env.envvars,u=v.env.secrets;if(i(r,"RELIABLY_EXPLORE_AWS")!==void 0){t.value=!0;const b=i(r,"RELIABLY_AWS_USE_SYSTEM_CREDS");U.value=b!==void 0;let o=i(r,"AWS_ACCESS_KEY_ID");R.value=o??"",o=i(u,"AWS_SECRET_ACCESS_KEY"),I.value=o??""}if(i(r,"RELIABLY_EXPLORE_K8S")!==void 0){g.value=!0;const b=i(r,"RELIABLY_K8S_USE_SYSTEM_CREDS");K.value=b!==void 0;let o=i(u,"KUBECONFIG");w.value=o??""}if(i(r,"RELIABLY_EXPLORE_GCP")!==void 0){E.value=!0;const b=i(r,"RELIABLY_GCP_USE_SYSTEM_CREDS");k.value=b!==void 0;let o=i(r,"GOOGLE_CLOUD_PROJECT_ID");O.value=o??"",o=i(r,"GOOGLE_CLOUD_REGION"),T.value=o??"",o=i(u,"GOOGLE_APPLICATION_CREDENTIALS"),x.value=o??""}}}function i(v,r){for(const u of v)if(u.var_name===r)return u.value}const d=a([]),c=a([]),D=async()=>{A.value=!0,t.value===!0&&(d.value.push({var_name:"RELIABLY_EXPLORE_AWS",value:"1"}),U.value===!0?d.value.push({var_name:"RELIABLY_AWS_USE_SYSTEM_CREDS",value:"1"}):(c.value.push({var_name:"AWS_ACCESS_KEY_ID",value:R.value,key:G(32)}),c.value.push({var_name:"AWS_SECRET_ACCESS_KEY",value:I.value,key:G(32)}))),E.value===!0&&(d.value.push({var_name:"RELIABLY_EXPLORE_GCP",value:"1"}),k.value===!0?d.value.push({var_name:"RELIABLY_GCP_USE_SYSTEM_CREDS",value:"1"}):(d.value.push({var_name:"GOOGLE_CLOUD_PROJECT_ID",value:O.value}),d.value.push({var_name:"GOOGLE_CLOUD_REGION",value:T.value}),c.value.push({var_name:"GOOGLE_APPLICATION_CREDENTIALS",value:x.value,key:G(32)}))),g.value===!0&&(d.value.push({var_name:"RELIABLY_EXPLORE_K8S",value:"1"}),K.value===!0?d.value.push({var_name:"RELIABLY_K8S_USE_SYSTEM_CREDS",value:"1"}):c.value.push({var_name:"KUBECONFIG",value:w.value,key:G(32)})),n.value===!0&&(d.value.push({var_name:"RELIABLY_EXPLORE_GITHUB",value:"1"}),c.value.push({var_name:"GITHUB_TOKEN",value:W.value,key:G(32)}));const v={name:C.value,envvars:d.value,secrets:c.value,used_for:"snapshot"};if(L.value===null){let u={integration_id:(await H({name:C.value,provider:"snapshot",vendor:"reliably",environment:v},!0))?.id};await F(u)}else{let r=L.value.integration_id;await M(r,v)}A.value=!1};ne(async()=>{P(),await j(),h()});const B={integrationName:C,hasCustomAWS:t,hasCustomGCP:E,hasCustomKubernetes:g,hasCustomGitHub:n,getSetTemplate:P,var_AwsUseSystemCreds:U,secret_AwsAccessKeyId:R,secret_AwsSecretAccessKey:I,var_GcpUseSystemCreds:k,var_GcpProjectId:O,var_GcpRegion:T,secret_GcpCredentials:x,var_k8sUseSystemCreds:K,secret_kubeConfig:w,secret_gitHubToken:W,isSubmitButtonInWaitMode:A,isSubmitDisabled:Y,refreshConfig:h,getEnvValue:i,envVars:d,envSecrets:c,proceed:D,ButtonLoader:X,AwsLogo:J,GoogleCloudLogo:z,KubernetesLogo:Q,GitHubLogo:Z};return Object.defineProperty(B,"__isScriptSetup",{enumerable:!1,value:!0}),B}}),re={class:"snapshotForm form"},oe={class:"inputWrapper"},le={class:"templatesSelector"},ie={for:"environmentTemplateAWS",title:"AWS"},ue={for:"environmentTemplateGCP",title:"Google Cloud"},de={for:"environmentTemplateKubernetes",title:"Kubernetes"},me={for:"environmentTemplateGitHub",title:"GitHub"},pe={key:0},ve={class:"inputWrapper"},fe={for:"awsUseSystemCreds",class:"flex"},_e={key:0,class:"inputWrapper"},ce={key:1,class:"inputWrapper"},Se={key:1},Ce={class:"inputWrapper"},Ee={for:"gcpUseSystemCreds",class:"flex"},ge={key:0,class:"inputWrapper"},be={key:1,class:"inputWrapper"},Ge={key:2,class:"inputWrapper"},ye={key:2},Ae={class:"inputWrapper"},Le={for:"k8sUseSystemCreds",class:"flex"},Ue={key:0,class:"inputWrapper"},Re={key:3},Ie={class:"inputWrapper"},ke={class:"inputWrapper"},Oe=["disabled"],Te={class:"button__loader"};function xe(N,s,C,t,E,g){return p(),m("form",re,[e("fieldset",null,[e("div",oe,[s[15]||(s[15]=e("label",{for:"integrationName"},[V(" Name "),e("span",{class:"required"},"Required")],-1)),l(e("input",{type:"text",name:"integrationName",id:"integrationName","onUpdate:modelValue":s[0]||(s[0]=n=>t.integrationName=n),required:""},null,512),[[_,t.integrationName]])])]),e("fieldset",null,[s[20]||(s[20]=e("legend",null,"Select systems to discover resources",-1)),e("div",le,[e("div",null,[l(e("input",{type:"checkbox","onUpdate:modelValue":s[1]||(s[1]=n=>t.hasCustomAWS=n),name:"environmentTemplateAWS",id:"environmentTemplateAWS"},null,512),[[S,t.hasCustomAWS]]),e("label",ie,[s[16]||(s[16]=e("span",{class:"screen-reader-text"},"AWS",-1)),y(t.AwsLogo)])]),e("div",null,[l(e("input",{type:"checkbox","onUpdate:modelValue":s[2]||(s[2]=n=>t.hasCustomGCP=n),name:"environmentTemplateGCP",id:"environmentTemplateGCP"},null,512),[[S,t.hasCustomGCP]]),e("label",ue,[s[17]||(s[17]=e("span",{class:"screen-reader-text"},"Google Cloud",-1)),y(t.GoogleCloudLogo)])]),e("div",null,[l(e("input",{type:"checkbox","onUpdate:modelValue":s[3]||(s[3]=n=>t.hasCustomKubernetes=n),name:"environmentTemplateKubernetes",id:"environmentTemplateKubernetes"},null,512),[[S,t.hasCustomKubernetes]]),e("label",de,[s[18]||(s[18]=e("span",{class:"screen-reader-text"},"Kubernetes",-1)),y(t.KubernetesLogo)])]),e("div",null,[l(e("input",{type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=n=>t.hasCustomGitHub=n),name:"environmentTemplateGitHub",id:"environmentTemplateGitHub"},null,512),[[S,t.hasCustomGitHub]]),e("label",me,[s[19]||(s[19]=e("span",{class:"screen-reader-text"},"GitHub",-1)),y(t.GitHubLogo)])])])]),t.hasCustomAWS?(p(),m("fieldset",pe,[s[24]||(s[24]=e("legend",null,"AWS Credentials",-1)),e("div",ve,[e("label",fe,[s[21]||(s[21]=e("span",null,"Use System Credentials",-1)),l(e("input",{type:"checkbox",name:"awsUseSystemCreds",id:"awsUseSystemCreds","onUpdate:modelValue":s[5]||(s[5]=n=>t.var_AwsUseSystemCreds=n),autocomplete:"off",required:""},null,512),[[S,t.var_AwsUseSystemCreds]])])]),t.var_AwsUseSystemCreds===!1?(p(),m("div",_e,[s[22]||(s[22]=e("label",{for:"awsKey",class:"flex"},[e("span",{class:"jsonString"},"AWS_ACCESS_KEY_ID"),e("span",{class:"required"},"Required "),e("span",{class:"secret flex-right"},"Secret")],-1)),l(e("input",{type:"text",name:"awsKey",id:"awsKey","onUpdate:modelValue":s[6]||(s[6]=n=>t.secret_AwsAccessKeyId=n),autocomplete:"off",required:""},null,512),[[_,t.secret_AwsAccessKeyId]])])):f("",!0),t.var_AwsUseSystemCreds===!1?(p(),m("div",ce,[s[23]||(s[23]=e("label",{for:"awsSecret",class:"flex"},[e("span",{class:"jsonString"},"AWS_SECRET_ACCESS_KEY"),e("span",{class:"required"},"Required"),e("span",{class:"secret flex-right"},"Secret")],-1)),l(e("input",{type:"text",name:"awsSecret",id:"awsSecret","onUpdate:modelValue":s[7]||(s[7]=n=>t.secret_AwsSecretAccessKey=n),autocomplete:"off",required:""},null,512),[[_,t.secret_AwsSecretAccessKey]])])):f("",!0)])):f("",!0),t.hasCustomGCP?(p(),m("fieldset",Se,[s[29]||(s[29]=e("legend",null,"Google Cloud Credentials",-1)),e("div",Ce,[e("label",Ee,[s[25]||(s[25]=e("span",null,"Use System Credentials",-1)),l(e("input",{type:"checkbox",name:"gcpUseSystemCreds",id:"gcpUseSystemCreds","onUpdate:modelValue":s[8]||(s[8]=n=>t.var_GcpUseSystemCreds=n),autocomplete:"off",required:""},null,512),[[S,t.var_GcpUseSystemCreds]])])]),t.var_GcpUseSystemCreds==!1?(p(),m("div",ge,[s[26]||(s[26]=e("label",{for:"gcpProjectId",class:"flex"},[e("span",{class:"jsonString"},"GOOGLE_CLOUD_PROJECT_ID"),e("span",{class:"envvar flex-right"},"Variable")],-1)),l(e("input",{type:"text",name:"gcpProjectId",id:"gcpProjectId","onUpdate:modelValue":s[9]||(s[9]=n=>t.var_GcpProjectId=n),autocomplete:"off",required:""},null,512),[[_,t.var_GcpProjectId]])])):f("",!0),t.var_GcpUseSystemCreds==!1?(p(),m("div",be,[s[27]||(s[27]=e("label",{for:"gcpRegion",class:"flex"},[e("span",{class:"jsonString"},"GOOGLE_CLOUD_REGION"),e("span",{class:"envvar flex-right"},"Variable")],-1)),l(e("input",{type:"text",name:"gcpRegion",id:"gcpRegion","onUpdate:modelValue":s[10]||(s[10]=n=>t.var_GcpRegion=n),autocomplete:"off",placeholder:"us-east1",required:""},null,512),[[_,t.var_GcpRegion]])])):f("",!0),t.var_GcpUseSystemCreds==!1?(p(),m("div",Ge,[s[28]||(s[28]=e("label",{for:"gcpConfigFile",class:"flex"},[e("span",{class:"jsonString"},"GOOGLE_APPLICATION_CREDENTIALS"),e("span",{class:"required"},"Required"),e("span",{class:"secret flex-right"},"Secret")],-1)),l(e("textarea",{name:"gcpConfigFile",id:"gcpConfigFile",placeholder:"Paste file content here","onUpdate:modelValue":s[11]||(s[11]=n=>t.secret_GcpCredentials=n),autocomplete:"off",required:""},null,512),[[_,t.secret_GcpCredentials]])])):f("",!0)])):f("",!0),t.hasCustomKubernetes?(p(),m("fieldset",ye,[s[32]||(s[32]=e("legend",null,"Kubernetes Credentials",-1)),e("div",Ae,[e("label",Le,[s[30]||(s[30]=e("span",null,"Use System Credentials",-1)),l(e("input",{type:"checkbox",name:"k8sUseSystemCreds",id:"k8sUseSystemCreds","onUpdate:modelValue":s[12]||(s[12]=n=>t.var_k8sUseSystemCreds=n),autocomplete:"off",required:""},null,512),[[S,t.var_k8sUseSystemCreds]])])]),t.var_k8sUseSystemCreds==!1?(p(),m("div",Ue,[s[31]||(s[31]=e("label",{for:"kubeConfigFile",class:"flex"},[e("span",{class:"jsonString"},"KUBECONFIG"),e("span",{class:"required"},"Required"),e("span",{class:"secret flex-right"},"Secret")],-1)),l(e("textarea",{name:"kubeConfigFile",id:"kubeConfigFile",placeholder:"Paste file content here","onUpdate:modelValue":s[13]||(s[13]=n=>t.secret_kubeConfig=n),autocomplete:"off",required:""},null,512),[[_,t.secret_kubeConfig]])])):f("",!0)])):f("",!0),t.hasCustomGitHub?(p(),m("fieldset",Re,[s[34]||(s[34]=e("legend",null,"GitHub Credentials",-1)),e("div",Ie,[s[33]||(s[33]=e("label",{for:"gitHubToken",class:"flex"},[e("span",{class:"jsonString"},"GITHUB_TOKEN"),e("span",{class:"required"},"Required "),e("span",{class:"secret flex-right"},"Secret")],-1)),l(e("input",{type:"text",name:"gitHubToken",id:"gitHubToken","onUpdate:modelValue":s[14]||(s[14]=n=>t.secret_gitHubToken=n),autocomplete:"off",required:""},null,512),[[_,t.secret_gitHubToken]])])])):f("",!0),e("fieldset",null,[e("div",ke,[e("button",{onClick:q(t.proceed,["prevent"]),disabled:t.isSubmitDisabled,class:se(["button button--primary",{"button--waiting":t.isSubmitButtonInWaitMode}])},[s[35]||(s[35]=V(" Start discovery ")),e("span",Te,[y(t.ButtonLoader)])],10,Oe)])])])}const ts=$(ae,[["render",xe],["__scopeId","data-v-f777b895"]]);export{ts as default};
