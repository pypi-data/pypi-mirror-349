import{v as u,c as g,w as V,a as re}from"./runtime-dom.esm-bundler.DChKj6X8.js";import{c as se}from"./environments.zePoF_Ox.js";import{g as C}from"./strings.Fm4VVZpd.js";import{h as F}from"./objects.CrQdKsRW.js";import{P as le}from"./PlusIcon.CLPjCzPo.js";import{M as oe}from"./MinusIcon.BnPCOBQF.js";import{B as ie}from"./ButtonLoader.DliJ452e.js";import{A as ue}from"./AwsLogo.UvCYOLAB.js";import{A as de}from"./AzureLogo.DtbZTzI3.js";import{G as ve}from"./GoogleCloudLogo.D_PfFuNt.js";import{K as me}from"./KubernetesLogoBlue.DW9q2K_R.js";import{G as pe}from"./GithubLogo.AFEE3hFH.js";/* empty css                     */import{_ as ce}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{d as fe,c as d,a as e,b as D,w as l,i as c,e as _,j,F as E,k as M,n as U,r as o,g as G,o as _e,h as v}from"./runtime-core.esm-bundler.Y6RLDZTT.js";import"./user.BEEfOshe.js";import"./user.Bg1Nd46A.js";import"./index.BSdFiPHn.js";import"./loader.BQDlK3Tc.js";import"./notifications.NSMm1_5U.js";import"./index.CwJxcYEt.js";import"./dayjs.min.xlbmdZiw.js";import"./duration.BGVtNWJ9.js";const Se=fe({__name:"EnvironmentForm",setup(O,{expose:t}){t();const y=o(""),n=o(!1),A=o(!1),T=o(!1),r=o(!1),a=o(!1);function i(){let s=window.location,f=new URLSearchParams(s.search);if(f.has("template")){const S=f.get("template");S==="aws"?n.value:S==="gcp"?A.value:S==="azure"?T.value:S==="kubernetes"&&r.value}}const z=o(""),q=o(""),h=o("/tmp/config"),R=o(""),N=o(""),K=o(""),W=o(""),P=o(""),I=o("/tmp/kubeconfig"),w=o(""),L=o(""),p=o([{var_name:"",value:""}]),Z=G(()=>p.value.length<2),Y=()=>{p.value.push({var_name:"",value:""})},J=s=>{p.value.splice(s,1)},m=o([{var_name:"",value:"",key:C(32)}]),b=o(["var"]),Q=G(()=>m.value.length<2),X=()=>{m.value.push({value:"",key:C(32)}),b.value.push("var")};function $(s){let f=m.value[s];if(b.value[s]==="var"){const S=f.path;f.var_name=S,delete f.path}else if(b.value[s]==="path"){const S=f.var_name;f.path=S,delete f.var_name}}const ee=s=>{m.value.splice(s,1),b.value.splice(s,1)},k=o(!1),te=G(()=>!!(y.value===""||k.value));function ne(s){return s.var_name!==void 0&&(s.var_name==="AWS_ACCESS_KEY_ID"||s.var_name==="AWS_SECRET_ACCESS_KEY")}function H(){p.value=p.value.filter(s=>(s.var_name=s.var_name.trim(),s.value=s.value.trim(),s.value!==""&&s.var_name!==""))}function x(){m.value=m.value.filter(s=>{if(s.value=s.value.trim(),s.value==="")return!1;if(F(s,"var_name"))return s.var_name=s.var_name?.trim(),s.var_name!=="";if(F(s,"path"))return s.path=s.path?.trim(),s.path!==""})}const ae=async()=>{k.value=!0,await H(),await x(),n.value===!0&&(m.value.push({var_name:"AWS_ACCESS_KEY_ID",value:z.value,key:C(32)}),m.value.push({var_name:"AWS_SECRET_ACCESS_KEY",value:q.value,key:C(32)})),A.value===!0&&(p.value.push({var_name:"GCP_APPLICATION_CREDENTIALS",value:h.value}),m.value.push({path:h.value,value:R.value,key:C(32)})),T.value===!0&&(p.value.push({var_name:"AZURE_CLIENT_ID",value:N.value}),p.value.push({var_name:"AZURE_TENANT_ID",value:K.value}),p.value.push({var_name:"AZURE_SUBSCRIPTION_ID",value:W.value}),m.value.push({var_name:"AZURE_CLIENT_SECRET",value:P.value,key:C(32)})),r.value===!0&&(p.value.push({var_name:"KUBECONFIG",value:I.value}),m.value.push({path:I.value,value:w.value,key:C(32)})),a.value===!0&&m.value.push({var_name:"GITHUB_TOKEN",value:L.value,key:C(32)});let s={name:y.value,envvars:p.value,secrets:m.value};await se(s),k.value=!1};_e(()=>{i()});const B={environmentName:y,hasCustomAWS:n,hasCustomGCP:A,hasCustomAzure:T,hasCustomKubernetes:r,hasCustomGitHub:a,getSetTemplate:i,secret_AwsAccessKeyId:z,secret_AwsSecretAccessKey:q,var_GcpCredentials:h,secret_GcpSecretConfigFile:R,var_azureClientId:N,var_azureTenantId:K,var_azureSubscriptionId:W,secret_azureClientSecret:P,var_kubeConfig:I,secret_kubeSecretConfigFile:w,secret_gitHubToken:L,envVars:p,hideRemoveVar:Z,addVar:Y,removeVar:J,envSecrets:m,envSecretsTypes:b,hideRemoveSecret:Q,addSecret:X,onSecretTypeChange:$,removeSecret:ee,isSubmitButtonInWaitMode:k,isSubmitDisabled:te,isSecretHidden:ne,filterVars:H,filterSecrets:x,proceed:ae,PlusIcon:le,MinusIcon:oe,ButtonLoader:ie,AwsLogo:ue,AzureLogo:de,GoogleCloudLogo:ve,KubernetesLogo:me,GitHubLogo:pe};return Object.defineProperty(B,"__isScriptSetup",{enumerable:!1,value:!0}),B}}),Ce={class:"environmentForm form"},be={class:"inputWrapper"},ge={class:"templatesSelector"},Ve={for:"environmentTemplateAWS",title:"AWS"},ye={for:"environmentTemplateGCP",title:"Google Cloud"},Ae={for:"environmentTemplateAzure",title:"Azure"},Te={for:"environmentTemplateKubernetes",title:"Kubernetes"},ke={for:"environmentTemplateGitHub",title:"GitHub"},he={key:0},Ie={class:"inputWrapper"},Ee={class:"inputWrapper"},Ue={key:1},Ge={class:"inputWrapper"},ze={class:"inputWrapper"},qe={for:"gcpConfigFile",class:"flex"},Re={class:"jsonString"},Ne={key:2},Ke={class:"inputWrapper"},We={class:"inputWrapper"},Pe={class:"inputWrapper"},we={class:"inputWrapper"},Le={key:3},He={class:"inputWrapper"},xe={class:"inputWrapper"},Be={for:"kubeConfigFile",class:"flex"},Fe={class:"jsonString"},De={key:4},je={class:"inputWrapper"},Me={class:"environmentVars"},Oe={class:"inputWrapper"},Ze=["onUpdate:modelValue"],Ye=["onUpdate:modelValue"],Je=["onClick"],Qe={class:"environmentSecrets"},Xe={class:"inputWrapper"},$e={class:"environmentSecrets__type"},et=["for"],tt=["onUpdate:modelValue","id","name","onChange"],nt={key:0,class:"environmentSecrets__path"},at=["for"],rt=["id","name","onUpdate:modelValue"],st={key:1,class:"environmentSecrets__name"},lt=["for"],ot=["id","name","onUpdate:modelValue"],it={key:2,class:"environmentSecrets__value environmentSecrets__value--var"},ut=["for"],dt=["id","name","onUpdate:modelValue"],vt={key:3,class:"environmentSecrets__value environmentSecrets__value--path"},mt=["for"],pt=["id","name","onUpdate:modelValue"],ct={class:"environmentSecrets__buttons"},ft=["onClick"],_t={class:"inputWrapper"},St=["disabled"],Ct={class:"button__loader"};function bt(O,t,y,n,A,T){return v(),d("form",Ce,[e("fieldset",null,[e("div",be,[t[17]||(t[17]=e("label",{for:"environmentName"},[D(" Environment name "),e("span",{class:"required"},"Required")],-1)),l(e("input",{type:"text",name:"environmentName",id:"environmentName","onUpdate:modelValue":t[0]||(t[0]=r=>n.environmentName=r),required:""},null,512),[[u,n.environmentName]])])]),e("fieldset",null,[t[23]||(t[23]=e("legend",null,"Add environment from template",-1)),e("div",ge,[e("div",null,[l(e("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=r=>n.hasCustomAWS=r),name:"environmentTemplateAWS",id:"environmentTemplateAWS"},null,512),[[g,n.hasCustomAWS]]),e("label",Ve,[t[18]||(t[18]=e("span",{class:"screen-reader-text"},"AWS",-1)),c(n.AwsLogo)])]),e("div",null,[l(e("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=r=>n.hasCustomGCP=r),name:"environmentTemplateGCP",id:"environmentTemplateGCP"},null,512),[[g,n.hasCustomGCP]]),e("label",ye,[t[19]||(t[19]=e("span",{class:"screen-reader-text"},"Google Cloud",-1)),c(n.GoogleCloudLogo)])]),e("div",null,[l(e("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=r=>n.hasCustomAzure=r),name:"environmentTemplateAzure",id:"environmentTemplateAzure"},null,512),[[g,n.hasCustomAzure]]),e("label",Ae,[t[20]||(t[20]=e("span",{class:"screen-reader-text"},"Azure",-1)),c(n.AzureLogo)])]),e("div",null,[l(e("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=r=>n.hasCustomKubernetes=r),name:"environmentTemplateKubernetes",id:"environmentTemplateKubernetes"},null,512),[[g,n.hasCustomKubernetes]]),e("label",Te,[t[21]||(t[21]=e("span",{class:"screen-reader-text"},"Kubernetes",-1)),c(n.KubernetesLogo)])]),e("div",null,[l(e("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=r=>n.hasCustomGitHub=r),name:"environmentTemplateGitHub",id:"environmentTemplateGitHub"},null,512),[[g,n.hasCustomGitHub]]),e("label",ke,[t[22]||(t[22]=e("span",{class:"screen-reader-text"},"GitHub",-1)),c(n.GitHubLogo)])])])]),n.hasCustomAWS?(v(),d("fieldset",he,[t[26]||(t[26]=e("legend",null,"AWS Vars and Secrets",-1)),e("div",Ie,[t[24]||(t[24]=e("label",{for:"awsKey",class:"flex"},[e("span",{class:"jsonString"},"AWS_ACCESS_KEY_ID"),e("span",{class:"required"},"Required "),e("span",{class:"secret flex-right"},"Secret")],-1)),l(e("input",{type:"text",name:"awsKey",id:"awsKey","onUpdate:modelValue":t[6]||(t[6]=r=>n.secret_AwsAccessKeyId=r),autocomplete:"off",required:""},null,512),[[u,n.secret_AwsAccessKeyId]])]),e("div",Ee,[t[25]||(t[25]=e("label",{for:"awsSecret",class:"flex"},[e("span",{class:"jsonString"},"AWS_SECRET_ACCESS_KEY"),e("span",{class:"required"},"Required"),e("span",{class:"secret flex-right"},"Secret")],-1)),l(e("input",{type:"text",name:"awsSecret",id:"awsSecret","onUpdate:modelValue":t[7]||(t[7]=r=>n.secret_AwsSecretAccessKey=r),autocomplete:"off",required:""},null,512),[[u,n.secret_AwsSecretAccessKey]])])])):_("",!0),n.hasCustomGCP?(v(),d("fieldset",Ue,[t[30]||(t[30]=e("legend",null,"Google Cloud Vars and Secrets",-1)),e("div",Ge,[t[27]||(t[27]=e("label",{for:"gcpCredentials",class:"flex"},[e("span",{class:"jsonString"},"GCP_APPLICATION_CREDENTIALS"),e("span",{class:"required"},"Required "),e("span",{class:"envvar flex-right"},"Variable")],-1)),l(e("input",{type:"text",name:"gcpCredentials",id:"gcpCredentials","onUpdate:modelValue":t[8]||(t[8]=r=>n.var_GcpCredentials=r),autocomplete:"off",required:""},null,512),[[u,n.var_GcpCredentials]])]),e("div",ze,[e("label",qe,[e("span",Re,j(n.var_GcpCredentials),1),t[28]||(t[28]=e("span",{class:"required"},"Required",-1)),t[29]||(t[29]=e("span",{class:"secret flex-right"},"Secret",-1))]),l(e("textarea",{name:"gcpConfigFile",id:"gcpConfigFile",placeholder:"Paste file content here","onUpdate:modelValue":t[9]||(t[9]=r=>n.secret_GcpSecretConfigFile=r),autocomplete:"off",required:""},null,512),[[u,n.secret_GcpSecretConfigFile]])])])):_("",!0),n.hasCustomAzure?(v(),d("fieldset",Ne,[t[35]||(t[35]=e("legend",null,"Azure Cloud Vars and Secrets",-1)),e("div",Ke,[t[31]||(t[31]=e("label",{for:"azureClientId",class:"flex"},[e("span",{class:"jsonString"},"AZURE_CLIENT_ID"),e("span",{class:"required"},"Required "),e("span",{class:"envvar flex-right"},"Variable")],-1)),l(e("input",{type:"text",name:"azureClientId",id:"azureClientId","onUpdate:modelValue":t[10]||(t[10]=r=>n.var_azureClientId=r),autocomplete:"off",required:""},null,512),[[u,n.var_azureClientId]])]),e("div",We,[t[32]||(t[32]=e("label",{for:"azureTenantId",class:"flex"},[e("span",{class:"jsonString"},"AZURE_TENANT_ID"),e("span",{class:"required"},"Required "),e("span",{class:"envvar flex-right"},"Variable")],-1)),l(e("input",{type:"text",name:"azureTenantId",id:"azureTenantId","onUpdate:modelValue":t[11]||(t[11]=r=>n.var_azureTenantId=r),autocomplete:"off",required:""},null,512),[[u,n.var_azureTenantId]])]),e("div",Pe,[t[33]||(t[33]=e("label",{for:"azureSubscriptionId",class:"flex"},[e("span",{class:"jsonString"},"AZURE_SUBSCRIPTION_ID"),e("span",{class:"required"},"Required"),e("span",{class:"envvar flex-right"},"Variable")],-1)),l(e("input",{type:"text",name:"azureSubscriptionId",id:"azureSubscriptionId","onUpdate:modelValue":t[12]||(t[12]=r=>n.var_azureSubscriptionId=r),autocomplete:"off",required:""},null,512),[[u,n.var_azureSubscriptionId]])]),e("div",we,[t[34]||(t[34]=e("label",{for:"azureClientSecret",class:"flex"},[e("span",{class:"jsonString"},"AZURE_CLIENT_SECRET"),e("span",{class:"required"},"Required "),e("span",{class:"secret flex-right"},"Secret")],-1)),l(e("input",{type:"text",name:"azureClientSecret",id:"azureClientSecret","onUpdate:modelValue":t[13]||(t[13]=r=>n.secret_azureClientSecret=r),autocomplete:"off",required:""},null,512),[[u,n.secret_azureClientSecret]])])])):_("",!0),n.hasCustomKubernetes?(v(),d("fieldset",Le,[t[39]||(t[39]=e("legend",null,"Kubernetes Vars and Secrets",-1)),e("div",He,[t[36]||(t[36]=e("label",{for:"kubeConfig",class:"flex"},[e("span",{class:"jsonString"},"KUBECONFIG"),e("span",{class:"required"},"Required "),e("span",{class:"envvar flex-right"},"Variable")],-1)),l(e("input",{type:"text",name:"kubeConfig",id:"kubeConfig","onUpdate:modelValue":t[14]||(t[14]=r=>n.var_kubeConfig=r),autocomplete:"off",required:""},null,512),[[u,n.var_kubeConfig]])]),e("div",xe,[e("label",Be,[e("span",Fe,j(n.var_kubeConfig),1),t[37]||(t[37]=e("span",{class:"required"},"Required",-1)),t[38]||(t[38]=e("span",{class:"secret flex-right"},"Secret",-1))]),l(e("textarea",{name:"kubeConfigFile",id:"kubeConfigFile",placeholder:"Paste file content here","onUpdate:modelValue":t[15]||(t[15]=r=>n.secret_kubeSecretConfigFile=r),autocomplete:"off",required:""},null,512),[[u,n.secret_kubeSecretConfigFile]])])])):_("",!0),n.hasCustomGitHub?(v(),d("fieldset",De,[t[41]||(t[41]=e("legend",null,"GitHub Vars and Secrets",-1)),e("div",je,[t[40]||(t[40]=e("label",{for:"gitHubToken",class:"flex"},[e("span",{class:"jsonString"},"GITHUB_TOKEN"),e("span",{class:"required"},"Required "),e("span",{class:"secret flex-right"},"Secret")],-1)),l(e("input",{type:"text",name:"gitHubToken",id:"gitHubToken","onUpdate:modelValue":t[16]||(t[16]=r=>n.secret_gitHubToken=r),autocomplete:"off",required:""},null,512),[[u,n.secret_gitHubToken]])])])):_("",!0),e("fieldset",Me,[t[45]||(t[45]=e("legend",null,"Environment Variables",-1)),e("div",Oe,[t[44]||(t[44]=e("div",{class:"environmentVars__labels"},[e("span",{id:"varName"},"Name"),e("span",{id:"varValue"},"Value")],-1)),(v(!0),d(E,null,M(n.envVars,(r,a)=>(v(),d("div",{class:"environmentVars__item",key:a},[l(e("input",{type:"text","aria-labelledby":"varName","onUpdate:modelValue":i=>n.envVars[a].var_name=i},null,8,Ze),[[u,n.envVars[a].var_name]]),l(e("input",{type:"text","aria-labelledby":"varValue","onUpdate:modelValue":i=>n.envVars[a].value=i},null,8,Ye),[[u,n.envVars[a].value]]),e("button",{class:U(["envVarButton",{"envVarButton--hidden":n.hideRemoveVar}]),onClick:V(i=>n.removeVar(a),["prevent"])},[t[42]||(t[42]=e("span",{class:"screen-reader-text"},"Remove this variable",-1)),c(n.MinusIcon)],10,Je),a===n.envVars.length-1?(v(),d("button",{key:0,class:"envVarButton",onClick:V(n.addVar,["prevent"])},[t[43]||(t[43]=e("span",{class:"screen-reader-text"},"Add a variable",-1)),c(n.PlusIcon)])):_("",!0)]))),128))])]),e("fieldset",Qe,[t[49]||(t[49]=e("legend",null,"Environment Secrets",-1)),e("div",Xe,[(v(!0),d(E,null,M(n.envSecrets,(r,a)=>(v(),d("div",{class:"environmentSecrets__item",key:a},[n.isSecretHidden(r)?_("",!0):(v(),d(E,{key:0},[e("div",$e,[e("label",{for:`secretType-${a}`},"Type",8,et),l(e("select",{"onUpdate:modelValue":i=>n.envSecretsTypes[a]=i,id:`secretType-${a}`,name:`secretType-${a}`,onChange:i=>n.onSecretTypeChange(a)},t[46]||(t[46]=[e("option",{value:"var"},"Variable",-1),e("option",{value:"path"},"Path",-1)]),40,tt),[[re,n.envSecretsTypes[a]]])]),n.envSecretsTypes[a]==="path"?(v(),d("div",nt,[e("label",{for:`secretPath-${a}`},"Path",8,at),l(e("input",{id:`secretPath-${a}`,name:`secretPath-${a}`,type:"text","onUpdate:modelValue":i=>n.envSecrets[a].path=i,autocomplete:"off"},null,8,rt),[[u,n.envSecrets[a].path]])])):(v(),d("div",st,[e("label",{for:`secretName-${a}`},"Name",8,lt),l(e("input",{id:`secretName-${a}`,name:`secretName-${a}`,type:"text","onUpdate:modelValue":i=>n.envSecrets[a].var_name=i,autocomplete:"off"},null,8,ot),[[u,n.envSecrets[a].var_name]])])),n.envSecretsTypes[a]==="var"?(v(),d("div",it,[e("label",{for:`secretValue-${a}`},"Value",8,ut),l(e("input",{id:`secretValue-${a}`,name:`secretValue-${a}`,type:"text","onUpdate:modelValue":i=>n.envSecrets[a].value=i,autocomplete:"off"},null,8,dt),[[u,n.envSecrets[a].value]])])):n.envSecretsTypes[a]==="path"?(v(),d("div",vt,[e("label",{for:`secretValue-${a}`},"Value",8,mt),l(e("textarea",{id:`secretValue-${a}`,name:`secretValue-${a}`,"onUpdate:modelValue":i=>n.envSecrets[a].value=i,placeholder:"Paste file content",autocomplete:"off"},null,8,pt),[[u,n.envSecrets[a].value]])])):_("",!0),e("div",ct,[e("button",{class:U(["envVarButton",{"envVarButton--hidden":n.hideRemoveSecret}]),onClick:V(i=>n.removeSecret(a),["prevent"])},[t[47]||(t[47]=e("span",{class:"screen-reader-text"},"Remove this secret",-1)),c(n.MinusIcon)],10,ft),a===n.envSecrets.length-1?(v(),d("button",{key:0,class:"envVarButton",onClick:V(n.addSecret,["prevent"])},[t[48]||(t[48]=e("span",{class:"screen-reader-text"},"Add a secret",-1)),c(n.PlusIcon)])):_("",!0)])],64))]))),128))])]),e("fieldset",null,[e("div",_t,[e("button",{onClick:V(n.proceed,["prevent"]),disabled:n.isSubmitDisabled,class:U(["button button--primary",{"button--waiting":n.isSubmitButtonInWaitMode}])},[t[50]||(t[50]=D(" Create environment ")),e("span",Ct,[c(n.ButtonLoader)])],10,St)])])])}const Ft=ce(Se,[["render",bt],["__scopeId","data-v-dc94e3fc"]]);export{Ft as default};
