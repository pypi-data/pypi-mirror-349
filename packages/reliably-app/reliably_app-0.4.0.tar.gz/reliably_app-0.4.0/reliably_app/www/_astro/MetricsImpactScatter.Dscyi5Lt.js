import{w as L}from"./runtime-dom.esm-bundler.DChKj6X8.js";import{C as T,S as R}from"./index.B8cAO9n_.js";import{m as V,l as j}from"./series.kU8HocMx.js";import{L as z}from"./LoadingPlaceholder.BoWrztnb.js";/* empty css                       */import{_ as A}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{u as U}from"./index.CwJxcYEt.js";import{d as W,c as b,a as C,n as P,l as y,e as w,r as l,g as q,p as F,o as G,h as c}from"./runtime-core.esm-bundler.Y6RLDZTT.js";import"./user.Bg1Nd46A.js";import"./index.BSdFiPHn.js";import"./loader.BQDlK3Tc.js";import"./notifications.NSMm1_5U.js";import"./contributions.K_0J8Jft.js";import"./objects.CrQdKsRW.js";import"./user.BEEfOshe.js";import"./dayjs.min.xlbmdZiw.js";/* empty css                       */const H=W({__name:"MetricsImpactScatter",setup(E,{expose:n}){n();const{Chart:m,Tooltip:t,Legend:f,PointElement:v,LineElement:d,LinearScale:k}=T;m.register(k,v,d,t,f);const h=l(!0),_=l(!1),p=l(!1),u=l(!1),N=q(()=>p.value||u.value),r=U(V),D=l({labels:[],datasets:[]}),x=l({labels:[],datasets:[]});async function S(){await j()}function I(){if(_.value=!0,r.value.distributions.impacts.per_plan.length>0&&(p.value=!0),r.value.distributions.impacts.per_tag?.length>0&&(u.value=!0),N.value){const e=r.value.distributions.impacts.per_plan,o=r.value.distributions.impacts.per_tag;p.value&&e.forEach(a=>{const s=a.deviated+a.completed===0?NaN:a.deviated/(a.deviated+a.completed)*100;let i={label:a.plan_title,data:[{x:a.total,y:Number.isNaN(s)?0:s}],backgroundColor:"#f3a93c"};Number.isNaN(s)?i.backgroundColor="hsl(285, 92%, 25%)":s<=30?i.backgroundColor="hsl(137, 57%, 41%)":s>=70&&(i.backgroundColor="hsl(0, 79%, 40%)"),D.value.datasets.push(i)}),u.value&&o.forEach(a=>{const s=a.deviated+a.completed===0?NaN:a.deviated/(a.deviated+a.completed)*100;let i={label:a.tag,data:[{x:a.total,y:Number.isNaN(s)?0:s}],backgroundColor:"#f3a93c"};Number.isNaN(s)?i.backgroundColor="hsl(285, 92%, 25%)":s<=30?i.backgroundColor="hsl(137, 57%, 41%)":s>=70&&(i.backgroundColor="hsl(0, 79%, 40%)"),x.value.datasets.push(i)})}_.value=!1}F(r,()=>I());const g=l("plan");function B(e){g.value=e}const O=l({responsive:!0,maintainAspectRatio:!1,pointRadius:6,scales:{x:{title:{display:!0,text:"Number of executions"},min:0,suggestedMax:10,ticks:{precision:0}},y:{title:{display:!0,text:"Deviation percentage"},afterDataLimits:e=>{e.max=100,e.min=0}}},plugins:{legend:{display:!1},tooltip:{callbacks:{title:function(e){const o=[];return e.forEach(a=>{o.push(a.dataset.label)}),o},label:function(e){const o=g.value==="plan"?r.value.distributions.impacts.per_plan[e.datasetIndex]:r.value.distributions.impacts.per_tag[e.datasetIndex];return`Total: ${o.total}. Deviated: ${o.deviated}. Completed: ${o.completed}. Unconclusive: ${o.total-(o.completed+o.deviated)}`}}}}});G(async()=>{h.value=!0,await S(),h.value=!1});const M={Chart:m,Tooltip:t,Legend:f,PointElement:v,LineElement:d,LinearScale:k,isMounting:h,isComputing:_,hasPlanData:p,hasTagData:u,hasData:N,storedData:r,planData:D,tagData:x,getData:S,computeData:I,displayedChart:g,display:B,chartOptions:O,get Scatter(){return R},LoadingPlaceholder:z};return Object.defineProperty(M,"__isScriptSetup",{enumerable:!1,value:!0}),M}}),J={class:"metricsImpact"},K={class:"metricsImpact__controls"},Q={key:1},X={key:2,class:"metricsImpact__wrapper"};function Y(E,n,m,t,f,v){return c(),b("div",J,[C("div",K,[C("button",{onClick:n[0]||(n[0]=L(d=>t.display("plan"),["prevent"])),class:P(["pill",{"pill--active":t.displayedChart==="plan"}])}," Per plan ",2),C("button",{onClick:n[1]||(n[1]=L(d=>t.display("tag"),["prevent"])),class:P(["pill",{"pill--active":t.displayedChart==="tag"}])}," Per tag ",2)]),t.isMounting||t.isComputing?(c(),y(t.LoadingPlaceholder,{key:0})):t.hasData?(c(),b("div",X,[t.displayedChart==="plan"?(c(),y(t.Scatter,{key:0,data:t.planData,options:t.chartOptions},null,8,["data","options"])):w("",!0),t.displayedChart==="tag"?(c(),y(t.Scatter,{key:1,data:t.tagData,options:t.chartOptions},null,8,["data","options"])):w("",!0)])):(c(),b("p",Q,"We don't have this data yet."))])}const vt=A(H,[["render",Y],["__scopeId","data-v-405e60f3"]]);export{vt as default};
