import{v as k,w as J}from"./runtime-dom.esm-bundler.DChKj6X8.js";import{l as w}from"./js-yaml.C-pQuU5J.js";import{i as C}from"./experiments.D7tm9rEg.js";import{i as E}from"./strings.Fm4VVZpd.js";import{c as T}from"./experiments.rwiqw3d6.js";import{E as V}from"./ExperimentContributions.DYiQPL7e.js";/* empty css                     */import{_ as g}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{d as M,c as _,a as i,n as N,w as O,j as P,e as b,l as j,r as a,g as x,h as c}from"./runtime-core.esm-bundler.Y6RLDZTT.js";import"./user.DMXaCJik.js";import"./user.TOXT8CXA.js";import"./index.BSdFiPHn.js";import"./loader.BQDlK3Tc.js";import"./notifications.NSMm1_5U.js";import"./index.CwJxcYEt.js";import"./dayjs.min.xlbmdZiw.js";import"./duration.BGVtNWJ9.js";import"./objects.CrQdKsRW.js";import"./PlusIcon.CLPjCzPo.js";import"./MinusIcon.BnPCOBQF.js";/* empty css                        */const D=M({__name:"ExperimentImportPaste",setup(I,{expose:o}){o();const r=a(""),e=a(""),n=a(null),s=a(!1),t=a(!1),y=x(()=>r.value!==""&&!t.value),p=a(""),d=a({availability:"none",latency:"none",security:"none",performance:"none"}),m=a(!1);let u=null;const h=()=>{e.value="",u!==null&&clearTimeout(u),u=setTimeout(function(){if(r.value!==""){if(E(r.value))n.value=JSON.parse(r.value),s.value=!0,e.value="JSON";else try{n.value=w(r.value),s.value=!0,e.value="YAML"}catch{s.value=!1,p.value="Input is not valid JSON nor YAML"}if(s.value){let l=T(n.value);if(l===""){t.value=!0,p.value="";const f=n.value;(f.contributions===void 0||Object.entries(f.contributions).length===0)&&(m.value=!0)}else t.value=!1,p.value=`Input is not a valid Chaos Toolkit experiment: ${l}.`}}else m.value=!1,p.value=""},500)},S=x(()=>r.value===""||!s.value||!t.value),v={rawInput:r,inputType:e,experimentJson:n,isFileReadable:s,isFileValidExperiment:t,errorState:y,message:p,contributions:d,areContributionsDisplayed:m,get timeout(){return u},set timeout(l){u=l},checkInputIsValid:h,isImportDisabled:S,importFromJson:async()=>{m.value&&(n.value.contributions=d.value);let l={experiment:JSON.stringify(n.value)};await C(l)},ExperimentContributions:V};return Object.defineProperty(v,"__isScriptSetup",{enumerable:!1,value:!0}),v}}),F={class:"experimentImportPaste"},L={class:"form"},B={key:0,class:"experimentImportPaste__type"},W=["innerHTML"],A={class:"inputWrapper"},Y=["disabled"];function z(I,o,r,e,n,s){return c(),_("div",F,[i("form",L,[i("fieldset",null,[i("div",{class:N(["inputWrapper",{"inputWrapper--error":e.errorState}])},[o[2]||(o[2]=i("label",{class:"screen-reader-text",for:"jsonInput"}," Paste the content of your experiment JSON or YAML file ",-1)),O(i("textarea",{name:"jsonInput",id:"jsonInput",wrap:"off","onUpdate:modelValue":o[0]||(o[0]=t=>e.rawInput=t),onKeyup:e.checkInputIsValid},null,544),[[k,e.rawInput]]),e.inputType!==""?(c(),_("div",B,P(e.inputType),1)):b("",!0),i("p",{class:"inputWrapper__help experimentImportPaste__info",innerHTML:e.message},null,8,W)],2),e.areContributionsDisplayed?(c(),j(e.ExperimentContributions,{key:0,modelValue:e.contributions,"onUpdate:modelValue":o[1]||(o[1]=t=>e.contributions=t),"import-mode":!0},null,8,["modelValue"])):b("",!0),i("div",A,[i("button",{onClick:J(e.importFromJson,["prevent"]),class:"button button--primary",disabled:e.isImportDisabled}," Import ",8,Y)])])])])}const ce=g(D,[["render",z],["__scopeId","data-v-c797a627"]]);export{ce as default};
