import{v as k,w as _,a as J}from"./runtime-dom.esm-bundler.DChKj6X8.js";import{g as Q,u as F,h as X,a as Z,e as $}from"./environments.1vY4QJYE.js";/* empty css                      */import{_ as W}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{d as A,t as j,r as v,h as l,c as d,a as t,j as L,w as C,F as T,g as U,b as N,f as H,k as z,i as P,l as h,m as V,e as g,o as ee}from"./runtime-core.esm-bundler.Y6RLDZTT.js";import{D as K}from"./DeleteButton.Ch6PF2gM.js";import{M as B}from"./ModalWindow.Go1bYN-e.js";import{E as Y}from"./EditIcon.VtRJix1y.js";import{h as I}from"./objects.CrQdKsRW.js";import{L as ne}from"./LoadingPlaceholder.BoWrztnb.js";import{N as te}from"./NoData.CWOJbPLy.js";import{T as oe}from"./TimeAgo.hHi23vP_.js";import{C as le}from"./ConfirmDeleteEnvironment.jyHchLew.js";import{g as O}from"./strings.Fm4VVZpd.js";import"./user.DMXaCJik.js";import"./user.TOXT8CXA.js";import"./index.BSdFiPHn.js";import"./loader.BQDlK3Tc.js";import"./notifications.NSMm1_5U.js";import"./index.CwJxcYEt.js";import"./TrashIcon.BzGEjUcP.js";import"./index.DUHDLdXK.js";import"./CloseIcon.DLOPA8gH.js";/* empty css                        *//* empty css                       *//* empty css                        */import"./dayjs.min.xlbmdZiw.js";/* empty css                       */import"./duration.BGVtNWJ9.js";const re=A({__name:"ConfirmDeleteEnvironmentSecretVar",props:{target:{},type:{},env:{}},emits:["close","refresh-environment"],setup(m,{expose:n,emit:c}){n();const e=m,{target:r,type:i,env:o}=j(e),s=v(""),a=c,p={props:e,target:r,type:i,env:o,confirmation:s,emit:a,cancel:()=>{a("close")},proceed:async()=>{if(s.value==="DELETE"){let f="";i.value==="secret"?f=r.value.key:i.value==="variable"&&(f=r.value.var_name),await Q(f,i.value,o.value)&&a("refresh-environment"),a("close")}}};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}}),ae={class:"inputWrapper"},ie={class:"inputWrapper"},se=["disabled"];function de(m,n,c,e,r,i){return l(),d(T,null,[t("p",null,"You are about to delete a "+L(e.type)+". This action cannot be undone.",1),n[2]||(n[2]=t("p",null,"Type 'DELETE' to proceed.",-1)),t("form",{class:"form",onSubmit:_(e.proceed,["prevent"])},[t("div",ae,[n[1]||(n[1]=t("label",{for:"confirmDelete"},null,-1)),C(t("input",{type:"text",id:"confirmDelete",name:"confirmDelete","onUpdate:modelValue":n[0]||(n[0]=o=>e.confirmation=o)},null,512),[[k,e.confirmation]])]),t("div",ie,[t("button",{onClick:_(e.cancel,["prevent"]),class:"button"},"Cancel"),t("button",{onClick:_(e.proceed,["prevent"]),class:"button button--destructive",disabled:e.confirmation!=="DELETE"}," Delete ",8,se)])],32)],64)}const q=W(re,[["render",de],["__scopeId","data-v-616f83f3"]]),ce=A({__name:"EditEnvironmentSecretVar",props:{target:{},type:{},env:{}},emits:["close","refresh-environment"],setup(m,{expose:n,emit:c}){n();const e=m,{target:r,type:i,env:o}=j(e),s=v(""),a=U(()=>i.value==="secret"&&r.value.path!==void 0),b=U(()=>a.value?r.value.path:r.value.var_name),u=c,w={props:e,target:r,type:i,env:o,newValue:s,isSecretPath:a,displayedName:b,emit:u,cancel:()=>{u("close")},proceed:async()=>{let y=null;i.value==="secret"?a.value?y={key:r.value.key,path:r.value.path,value:s.value}:y={key:r.value.key,var_name:r.value.var_name,value:s.value}:y={var_name:r.value.var_name,value:s.value},await F(y,i.value,o.value)&&u("refresh-environment"),u("close")}};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}}),ve={class:"form"},me={class:"inputWrapper"},ue={for:"newValue"},pe={class:"jsonString jsonString--envvar"},_e=["placeholder"],fe={class:"inputWrapper"},ye=["disabled"];function be(m,n,c,e,r,i){return l(),d("form",ve,[t("div",me,[t("label",ue,[N("Enter a new value for "+L(e.type)+" ",1),t("span",pe,L(e.displayedName),1)]),e.isSecretPath?C((l(),d("textarea",{key:0,id:"newValue",name:"newValue",placeholder:"Paste new file content","onUpdate:modelValue":n[0]||(n[0]=o=>e.newValue=o)},null,512)),[[k,e.newValue]]):C((l(),d("input",{key:1,type:"text",id:"newValue",name:"newValue",placeholder:`New ${e.type} value`,"onUpdate:modelValue":n[1]||(n[1]=o=>e.newValue=o)},null,8,_e)),[[k,e.newValue]])]),t("div",fe,[t("button",{onClick:_(e.cancel,["prevent"]),class:"button"},"Cancel"),t("button",{onClick:_(e.proceed,["prevent"]),class:"button button--creative",disabled:e.newValue===""}," Save ",8,ye)])])}const G=W(ce,[["render",be],["__scopeId","data-v-d306dc38"]]),Ee=A({__name:"EnvironmentVars",props:{vars:{},env:{}},emits:["refresh-environment"],setup(m,{expose:n,emit:c}){n();const e=m,{vars:r,env:i}=j(e),o=c,s=v(null),a=v(!1);function b(){s.value=null,a.value=!1}function u(D){s.value=D,a.value=!0}const p=v(!1);function f(){s.value=null,p.value=!1}function w(D){s.value=D,p.value=!0}function y(){o("refresh-environment")}const E={props:e,vars:r,env:i,emit:o,currentVar:s,isDeleteDisplayed:a,closeDelete:b,displayDelete:u,isEditDisplayed:p,closeEdit:f,displayEdit:w,refreshEnvironment:y,ConfirmDeleteEnvironmentSecretVar:q,EditEnvironmentSecretVar:G,DeleteButton:K,ModalWindow:B,EditIcon:Y};return Object.defineProperty(E,"__isScriptSetup",{enumerable:!1,value:!0}),E}}),he={class:"environmentVars tableList"},Ve={class:"tableList__cell jsonString jsonString--envvar"},Ce={class:"tableList__cell"},ge={class:"environmentVars__actions tableList__cell tableList__cell--small"},we=["onClick"],Se={key:1},ke={key:1};function De(m,n,c,e,r,i){return l(),d(T,null,[t("ul",he,[n[0]||(n[0]=H('<li class="tableList__row tableList__row--header"><div class="tableList__cell">Name</div><div class="tableList__cell">Value</div><div class="tableList__cell tableList__cell--small"><span class="screen-reader-text">Actions</span></div></li>',1)),(l(!0),d(T,null,z(e.vars,(o,s)=>(l(),d("li",{key:s,class:"tableList__row"},[t("div",Ve,L(o.var_name),1),t("div",Ce,L(o.value),1),t("div",ge,[t("button",{class:"button button--icon hasTooltip hasTooltip--bottom-center",label:"Edit","aria-label":"Edit",onClick:_(a=>e.displayEdit(o),["prevent"])},[P(e.EditIcon)],8,we),P(e.DeleteButton,{onClick:_(a=>e.displayDelete(o),["prevent"])},null,8,["onClick"])])]))),128))]),e.isDeleteDisplayed?(l(),h(e.ModalWindow,{key:0,hasCloseButton:!0,hasPadding:!0,onClose:e.closeDelete},{title:V(()=>n[1]||(n[1]=[N("Delete Environment Variable")])),content:V(()=>[e.currentVar!==null?(l(),h(e.ConfirmDeleteEnvironmentSecretVar,{key:0,target:e.currentVar,type:"variable",env:e.env,onClose:e.closeDelete,onRefreshEnvironment:e.refreshEnvironment},null,8,["target","env"])):(l(),d("div",Se,"Something went wrong. Please try again."))]),_:1})):g("",!0),e.isEditDisplayed?(l(),h(e.ModalWindow,{key:1,hasCloseButton:!0,hasPadding:!0,onClose:e.closeEdit},{title:V(()=>n[2]||(n[2]=[N("Edit Environment Variable")])),content:V(()=>[e.currentVar!==null?(l(),h(e.EditEnvironmentSecretVar,{key:0,target:e.currentVar,type:"variable",env:e.env,onClose:e.closeEdit,onRefreshEnvironment:e.refreshEnvironment},null,8,["target","env"])):(l(),d("div",ke,"Something went wrong. Please try again."))]),_:1})):g("",!0)],64)}const Pe=W(Ee,[["render",De]]),Ne=A({__name:"EnvironmentSecrets",props:{secrets:{},env:{}},emits:["refresh-environment"],setup(m,{expose:n,emit:c}){n();const e=m,{secrets:r,env:i}=j(e),o=c;function s(S){return I(S,"path")?S.path:I(S,"var_name")?S.var_name:""}const a=v(null),b=v(!1);function u(){a.value=null,b.value=!1}function p(S){a.value=S,b.value=!0}const f=v(!1);function w(){a.value=null,f.value=!1}function y(S){a.value=S,f.value=!0}function E(){o("refresh-environment")}const D={props:e,secrets:r,env:i,emit:o,pathOrEnv:s,currentSecret:a,isDeleteDisplayed:b,closeDelete:u,displayDelete:p,isEditDisplayed:f,closeEdit:w,displayEdit:y,refreshEnvironment:E,ConfirmDeleteEnvironmentSecretVar:q,EditEnvironmentSecretVar:G,DeleteButton:K,ModalWindow:B,EditIcon:Y};return Object.defineProperty(D,"__isScriptSetup",{enumerable:!1,value:!0}),D}}),xe={class:"environmentSecrets tableList"},Le={class:"tableList__cell jsonString jsonString--envvar"},Te={class:"environmentSecrets__actions tableList__cell tableList__cell--small"},We=["onClick"],Ae={key:1},je={key:1};function Be(m,n,c,e,r,i){return l(),d(T,null,[t("ul",xe,[n[1]||(n[1]=H('<li class="tableList__row tableList__row--header"><div class="tableList__cell">Name or Path</div><div class="tableList__cell"></div><div class="tableList__cell tableList__cell--small"><span class="screen-reader-text">Actions</span></div></li>',1)),(l(!0),d(T,null,z(e.secrets,(o,s)=>(l(),d("li",{key:s,class:"tableList__row"},[t("div",Le,L(e.pathOrEnv(o)),1),n[0]||(n[0]=t("div",{class:"tableList__cell jsonString jsonString--envvar"},"********",-1)),t("div",Te,[t("button",{class:"button button--icon hasTooltip hasTooltip--bottom-center",label:"Edit","aria-label":"Edit",onClick:_(a=>e.displayEdit(o),["prevent"])},[P(e.EditIcon)],8,We),P(e.DeleteButton,{onClick:_(a=>e.displayDelete(o),["prevent"])},null,8,["onClick"])])]))),128))]),e.isDeleteDisplayed?(l(),h(e.ModalWindow,{key:0,hasCloseButton:!0,hasPadding:!0,onClose:e.closeDelete},{title:V(()=>n[2]||(n[2]=[N("Delete Secret")])),content:V(()=>[e.currentSecret!==null?(l(),h(e.ConfirmDeleteEnvironmentSecretVar,{key:0,target:e.currentSecret,type:"secret",env:e.env,onClose:e.closeDelete,onRefreshEnvironment:e.refreshEnvironment},null,8,["target","env"])):(l(),d("div",Ae,"Something went wrong. Please try again."))]),_:1})):g("",!0),e.isEditDisplayed?(l(),h(e.ModalWindow,{key:1,hasCloseButton:!0,hasPadding:!0,onClose:e.closeEdit},{title:V(()=>n[3]||(n[3]=[N("Edit Secret")])),content:V(()=>[e.currentSecret!==null?(l(),h(e.EditEnvironmentSecretVar,{key:0,target:e.currentSecret,type:"secret",env:e.env,onClose:e.closeEdit,onRefreshEnvironment:e.refreshEnvironment},null,8,["target","env"])):(l(),d("div",je,"Something went wrong. Please try again."))]),_:1})):g("",!0)],64)}const Me=W(Ne,[["render",Be]]),Re=A({__name:"CloneEnvironmentForm",props:{id:{},name:{}},emits:["close"],setup(m,{expose:n,emit:c}){n();const e=m,{id:r,name:i}=j(e),o=v(""),s=c,u={props:e,id:r,name:i,cloneName:o,emit:s,cancel:()=>{s("close")},proceed:async()=>{r.value!==void 0&&o.value!==""&&await X(r.value,o.value)}};return Object.defineProperty(u,"__isScriptSetup",{enumerable:!1,value:!0}),u}}),Ue={class:"form"},Ie={class:"inputWrapper"},Oe=["placeholder"],Fe={class:"inputWrapper"},He=["disabled"];function ze(m,n,c,e,r,i){return l(),d(T,null,[n[2]||(n[2]=t("p",null,"Please provide a name for the new environment.",-1)),n[3]||(n[3]=t("p",null," All current environment variables and secrets will be added to the clone. ",-1)),t("form",Ue,[t("div",Ie,[n[1]||(n[1]=t("label",{for:"newName"},null,-1)),C(t("input",{type:"text",id:"newName",name:"newName",placeholder:e.name,"onUpdate:modelValue":n[0]||(n[0]=o=>e.cloneName=o)},null,8,Oe),[[k,e.cloneName]])]),t("div",Fe,[t("button",{onClick:_(e.cancel,["prevent"]),class:"button"},"Cancel"),t("button",{onClick:_(e.proceed,["prevent"]),class:"button button--primary",disabled:e.cloneName===""}," Clone environment ",8,He)])])],64)}const Ke=W(Re,[["render",ze],["__scopeId","data-v-9f2dc336"]]),Ye=A({__name:"AddEnvironmentSecretVar",props:{type:{},env:{}},emits:["close","refresh-environment"],setup(m,{expose:n,emit:c}){n();const e=m,{type:r,env:i}=j(e),o=c,s=()=>{o("close")},a=v(""),b=v(""),u=v("var"),p=v(""),f=v(""),y={props:e,type:r,env:i,emit:o,cancel:s,varName:a,varValue:b,secretType:u,secretNamePath:p,secretValue:f,proceed:async()=>{let E=null;r.value==="secret"?u.value==="var"?E={key:O(32),var_name:p.value.trim(),value:f.value}:E={key:O(32),path:p.value.trim(),value:f.value}:E={var_name:a.value.trim(),value:b.value},await F(E,r.value,i.value)&&o("refresh-environment"),o("close")}};return Object.defineProperty(y,"__isScriptSetup",{enumerable:!1,value:!0}),y}}),qe={class:"form"},Ge={class:"inputWrapper"},Je={class:"inputWrapper"},Qe={class:"inputWrapper"},Xe=["for"],Ze=["id","name"],$e={key:0,class:"inputWrapper"},en={key:1,class:"inputWrapper"},nn={key:2,class:"inputWrapper"},tn={key:3,class:"inputWrapper"},on={class:"inputWrapper"},ln=["disabled"];function rn(m,n,c,e,r,i){return l(),d("form",qe,[e.type==="variable"?(l(),d(T,{key:0},[t("div",Ge,[n[7]||(n[7]=t("label",{for:"varName"},"Name",-1)),C(t("input",{type:"text",id:"varName",name:"varName","onUpdate:modelValue":n[0]||(n[0]=o=>e.varName=o)},null,512),[[k,e.varName]])]),t("div",Je,[n[8]||(n[8]=t("label",{for:"varName"},"Value",-1)),C(t("input",{type:"text",id:"varValue",name:"varValue","onUpdate:modelValue":n[1]||(n[1]=o=>e.varValue=o)},null,512),[[k,e.varValue]])])],64)):e.type==="secret"?(l(),d(T,{key:1},[t("div",Qe,[t("label",{for:e.secretType},"Type",8,Xe),C(t("select",{"onUpdate:modelValue":n[2]||(n[2]=o=>e.secretType=o),id:e.secretType,name:e.secretType},n[9]||(n[9]=[t("option",{value:"var"},"Variable",-1),t("option",{value:"path"},"Path",-1)]),8,Ze),[[J,e.secretType]])]),e.secretType==="var"?(l(),d("div",$e,[n[10]||(n[10]=t("label",{for:"secretName"},"Name",-1)),C(t("input",{type:"text",id:"secretName",name:"secretName","onUpdate:modelValue":n[3]||(n[3]=o=>e.secretNamePath=o)},null,512),[[k,e.secretNamePath]])])):g("",!0),e.secretType==="path"?(l(),d("div",en,[n[11]||(n[11]=t("label",{for:"secretPath"},"Path",-1)),C(t("input",{type:"text",id:"secretPath",name:"secretPath","onUpdate:modelValue":n[4]||(n[4]=o=>e.secretNamePath=o)},null,512),[[k,e.secretNamePath]])])):g("",!0),e.secretType==="var"?(l(),d("div",nn,[n[12]||(n[12]=t("label",{for:"secretVarValue"},"Value",-1)),C(t("input",{type:"text",id:"secretVarValue",name:"secretVarValue","onUpdate:modelValue":n[5]||(n[5]=o=>e.secretValue=o)},null,512),[[k,e.secretValue]])])):e.secretType==="path"?(l(),d("div",tn,[n[13]||(n[13]=t("label",{for:"secretPathValue"},"Value",-1)),C(t("textarea",{id:"secretPathValue",name:"secretPathValue",placeholder:"Paste file content","onUpdate:modelValue":n[6]||(n[6]=o=>e.secretValue=o)},null,512),[[k,e.secretValue]])])):g("",!0)],64)):g("",!0),t("div",on,[t("button",{onClick:_(e.cancel,["prevent"]),class:"button"},"Cancel"),t("button",{onClick:_(e.proceed,["prevent"]),class:"button button--creative",disabled:e.varValue===""&&e.secretValue===""}," Save ",8,ln)])])}const an=W(Ye,[["render",rn],["__scopeId","data-v-6929cebc"]]),sn=A({__name:"EnvironmentView",setup(m,{expose:n}){n();const c=v(!0),e=v(void 0),r=v(void 0),i=()=>{let x=window.location,R=new URLSearchParams(x.search);R.has("id")&&(e.value=R.get("id"))},o=async()=>{await Z(e.value),r.value=$.get()},s=()=>{let x="Environment · Reliably";r.value!==void 0&&(x=`${r.value.name} environment · Reliably`),document.title=x},a=v(!1),b=()=>{a.value=!0},u=()=>{a.value=!1},p=v(!1);function f(){p.value=!0}function w(){p.value=!1}const y=v(null),E=v(!1);function D(){y.value=null,E.value=!1}function S(x){(x==="secret"||x==="variable")&&(y.value=x),E.value=!0}ee(async()=>{c.value=!0,i(),await o(),s(),c.value=!1});const M={isLoading:c,id:e,env:r,getCurrentId:i,getEnvironment:o,setMetaData:s,isDeleteDisplayed:a,displayDelete:b,closeDelete:u,isCloneDisplayed:p,openClone:f,closeClone:w,typeToAdd:y,isAddDisplayed:E,closeAdd:D,displayAdd:S,EnvironmentVars:Pe,EnvironmentSecrets:Me,LoadingPlaceholder:ne,NoData:te,TimeAgo:oe,ModalWindow:B,ConfirmDeleteEnvironment:le,CloneEnvironmentForm:Ke,AddEnvironmentSecretVar:an};return Object.defineProperty(M,"__isScriptSetup",{enumerable:!1,value:!0}),M}}),dn={key:1,class:"environmentView"},cn={class:"pageHeader"},vn={class:"pageHeader__title"},mn={class:"pageHeader__actions"},un={class:"environmentInfo"},pn={class:"environmentVarsWrapper"},_n={class:"environmentVarsWrapper"},fn={key:1};function yn(m,n,c,e,r,i){return e.isLoading?(l(),h(e.LoadingPlaceholder,{key:0,size:"large"})):e.env!==void 0&&e.env.id?(l(),d("article",dn,[t("header",cn,[t("div",null,[t("h1",vn,L(e.env.name),1)]),t("div",mn,[t("button",{class:"button button--destructiveLight",onClick:_(e.displayDelete,["prevent"])}," Delete environment "),t("button",{class:"button button--primary",onClick:_(e.openClone,["prevent"])}," Clone environment "),n[2]||(n[2]=t("a",{href:"/environments/new/",class:"button button--creative"},"New environment",-1))])]),t("section",un,[n[3]||(n[3]=N(" Created ")),P(e.TimeAgo,{timestamp:e.env.created_date},null,8,["timestamp"])]),t("section",pn,[t("header",null,[n[4]||(n[4]=t("h2",null,"Environment Secrets",-1)),t("button",{onClick:n[0]||(n[0]=_(o=>e.displayAdd("secret"),["prevent"])),class:"button button--creative button--small"}," Add a secret ")]),n[5]||(n[5]=t("p",null," Secrets are encrypted environment variables. They are accessible only by Reliably in the context of this environment. ",-1)),P(e.EnvironmentSecrets,{secrets:e.env.secrets,env:e.id,onRefreshEnvironment:e.getEnvironment},null,8,["secrets","env"])]),t("section",_n,[t("header",null,[n[6]||(n[6]=t("h2",null,"Environment Variables",-1)),t("button",{onClick:n[1]||(n[1]=_(o=>e.displayAdd("variable"),["prevent"])),class:"button button--creative button--small"}," Add a variable ")]),n[7]||(n[7]=t("p",null," Variables are used for non-sensitive configuration data. They are accessible only by Reliably in the context of this environment. ",-1)),P(e.EnvironmentVars,{vars:e.env.envvars,env:e.id,onRefreshEnvironment:e.getEnvironment},null,8,["vars","env"])]),e.isDeleteDisplayed?(l(),h(e.ModalWindow,{key:0,hasCloseButton:!0,hasPadding:!0,onClose:e.closeDelete},{title:V(()=>n[8]||(n[8]=[N("Delete Environment")])),content:V(()=>[P(e.ConfirmDeleteEnvironment,{id:e.env.id,onClose:e.closeDelete},null,8,["id"])]),_:1})):g("",!0),e.isCloneDisplayed?(l(),h(e.ModalWindow,{key:1,hasCloseButton:!0,hasPadding:!0,onClose:e.closeClone},{title:V(()=>n[9]||(n[9]=[N("Clone Environment")])),content:V(()=>[P(e.CloneEnvironmentForm,{id:e.env.id,name:e.env.name,onClose:e.closeClone},null,8,["id","name"])]),_:1})):g("",!0),e.isAddDisplayed?(l(),h(e.ModalWindow,{key:2,hasCloseButton:!0,hasPadding:!0,onClose:e.closeAdd},{title:V(()=>[N("Add Environment "+L(e.typeToAdd),1)]),content:V(()=>[e.typeToAdd!==null?(l(),h(e.AddEnvironmentSecretVar,{key:0,type:e.typeToAdd,env:e.env.id,onClose:e.closeAdd,onRefreshEnvironment:e.getEnvironment},null,8,["type","env"])):(l(),d("div",fn,"Something went wrong. Please try again."))]),_:1})):g("",!0)])):(l(),h(e.NoData,{key:2,message:"We couldn't find a deployment with this ID."}))}const qn=W(sn,[["render",yn],["__scopeId","data-v-ad96cf3b"]]);export{qn as default};
