import{w as V}from"./runtime-dom.esm-bundler.DChKj6X8.js";import{d as B}from"./dayjs.min.xlbmdZiw.js";import{t as I,T as O}from"./TimeAgo.hHi23vP_.js";import{s as G}from"./strings.Fm4VVZpd.js";import{g as A,a as F,C as H}from"./ConfirmDeletePlan.GLrP9XTB.js";import{G as W}from"./GithubLogo.AFEE3hFH.js";import{R as q}from"./ReliablyRLogo.BeZqNTy5.js";import{D as J}from"./DockerLogo.DO2Y8vmm.js";import{K as Q}from"./KubernetesLogo.HTj9OyEL.js";import{M as X}from"./ModalWindow.Go1bYN-e.js";/* empty css                      */import{_ as z}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{d as Z,t as K,g as y,h as n,c as l,a as t,j as i,n as Y,r as d,o as $,i as o,b as D,F as ee,e as u,l as te,m as j}from"./runtime-core.esm-bundler.Y6RLDZTT.js";import{b as ne,e as le}from"./experiments.D7tm9rEg.js";import{g as ie,a as ae}from"./plans.DbuQ6lqo.js";import{D as oe}from"./DeleteButton.Ch6PF2gM.js";const se=Z({__name:"PlanMiniStatus",props:{status:{}},setup(_,{expose:s}){s();const c=_,{status:e}=K(c),p=y(()=>e.value.status==="creating"?"planStatus--creating":e.value.status==="created"?"planStatus--scheduled":e.value.status==="creation error"||e.value.status==="deletion error"||e.value.status==="suspending"||e.value.status==="suspended"||e.value.status==="resuming"?"planStatus--warning":e.value.status==="error"||e.value.status==="suspend_error"||e.value.status==="resuming_error"?"planStatus--error":e.value.status==="running"?"planStatus--running":e.value.status==="completed"?"planStatus--completed":e.value.status==="deleting"?"planStatus--deleting":"planStatus--unknown"),m=y(()=>e.value.status==="creating"?"Creating...":e.value.status==="created"?e.value.error===null?"Scheduled":"Error after creation":e.value.status==="creation error"?e.value.error===null?"Plan couldn't be scheduled":`Plan couldn't be scheduled: ${e.value.error}`:e.value.status==="deletion error"?e.value.error===null?"Plan couldn't be deleted":`Plan couldn't be deleted: ${e.value.error}`:e.value.status==="suspend_error"?e.value.error===null?"Plan schedule couldn't be suspended":`Plan schedule couldn't be suspended: ${e.value.error}`:e.value.status==="resuming_error"?e.value.error===null?"Plan schedule couldn't be resumed":`Plan schedule couldn't be resumed: ${e.value.error}`:e.value.status==="error"?e.value.error===null?"error":e.value.error:e.value.status==="running"?"Running":e.value.status==="completed"?"Completed":e.value.status==="suspended"?"Suspended":e.value.status==="suspending"?"Suspending":e.value.status==="resuming"?"Resuming":e.value.status==="deleting"?"Deleting":"Unknown"),f={props:c,status:e,statusClass:p,statusLabel:m};return Object.defineProperty(f,"__isScriptSetup",{enumerable:!1,value:!0}),f}}),re=["title"],de={class:"screen-reader-text"};function ue(_,s,c,e,p,m){return n(),l("span",{class:Y(["planStatus",e.statusClass]),title:e.statusLabel},[t("span",de,i(e.statusLabel),1)],10,re)}const ce=z(se,[["render",ue],["__scopeId","data-v-4f44561c"]]),_e=Z({__name:"PlanPreview",props:{plan:{},page:{},store:{}},setup(_,{expose:s}){s();const c=_,{plan:e,page:p,store:m}=K(c),f=y(()=>({status:e.value.status,error:e.value.error?e.value.error:null})),h=d(["-",""]),g=d(["-",""]),L=d("");function x(){const r=A(e.value);if(r!==null){const a=r.split(" ");a[0]&&a[0]!==""&&(h.value[0]=a[0]),a[1]&&a[1]!==""&&(h.value[1]=a[1])}const M=F(e.value?.definition.schedule);if(M!==null){const a=M.split(" ");a[0]&&a[0]!==""&&(g.value[0]=a[0]),a[1]&&a[1]!==""&&(g.value[1]=a[1])}B.extend(I),L.value=B.tz.guess()}const b=y(()=>e.value.definition.experiments),v=d(null),k=d(""),R=async()=>{await ne(b.value[0]),v.value=le.get(),k.value=v.value===null?G(b.value[0]):v.value.definition.title},S=d(null);async function C(){if(e.value.definition.environment&&e.value.definition.environment.id){const r=await ie(e.value.definition.environment.id,e.value.definition.environment.provider);r&&(S.value=r)}}const w=d("");async function N(){if(e.value.definition.deployment.deployment_id){const r=await ae(e.value.definition.deployment.deployment_id);r?w.value=r:w.value=e.value.definition.deployment.deployment_id}}const P=d(!1),T=()=>{P.value=!0},U=()=>{P.value=!1};$(async()=>{await R(),x(),await C(),await N()});const E={props:c,plan:e,page:p,store:m,computedStatus:f,lastRun:h,nextRun:g,browserZone:L,getLastNext:x,experiments:b,exp:v,displayedExperimentName:k,getExperiment:R,env:S,getEnvName:C,dep:w,getDepName:N,isDeleteDisplayed:P,displayDelete:T,closeDelete:U,get shortenUuid(){return G},TimeAgo:O,GithubLogo:W,ReliablyLogo:q,DockerLogo:J,KubernetesLogo:Q,ModalWindow:X,ConfirmDeletePlan:H,PlanMiniStatus:ce,DeleteButton:oe};return Object.defineProperty(E,"__isScriptSetup",{enumerable:!1,value:!0}),E}}),pe={class:"planPreview tableList__row"},me={class:"tableList__cell tableList__cell--center tableList__cell--status"},fe={class:"tableList__cell planPreview__meta"},ve=["href"],ye=["href"],he={class:"tableList__cell planPreview__env"},ge={key:0},be={key:1},we=["href"],Pe={class:"tableList__cell planPreview__dep"},De={key:0,title:"GitHub Deployment"},Le=["href"],xe={key:1,title:"Reliably Deployment"},ke=["href"],Re={key:2,title:"Reliably CLI Deployment"},Se=["href"],Ce={key:3,title:"Docker Container Deployment"},Ne=["href"],Ee={key:4,title:"Kubernetes Deployment"},Me=["href"],Be={key:5},Ge=["href"],je={class:"tableList__cell planPreview__runs"},ze={class:"tableList__cell planPreview__last"},Ze=["title"],Ke={key:1},Te={class:"tableList__cell planPreview__next"},Ue=["title"],Ve={key:1},Ie={class:"tableList__cell planPreview__schedule"},Oe={key:0},Ae={key:1},Fe={class:"tableList__cell tableList__cell--small"};function He(_,s,c,e,p,m){return n(),l("li",pe,[t("div",me,[o(e.PlanMiniStatus,{status:e.computedStatus},null,8,["status"])]),t("div",fe,[e.plan.definition.title?(n(),l("a",{key:0,href:`/plans/view/?id=${e.plan.id}`},i(e.plan.definition.title),9,ve)):(n(),l("a",{key:1,href:`/plans/view/?id=${e.plan.id}`},i(e.shortenUuid(e.plan.id)),9,ye)),t("small",null,i(e.plan.id),1),t("small",null,[s[0]||(s[0]=D("Created ")),o(e.TimeAgo,{timestamp:e.plan.created_date},null,8,["timestamp"])])]),t("div",he,[e.plan.definition.environment?(n(),l(ee,{key:0},[e.plan.definition.environment.provider==="github"?(n(),l("span",ge,[o(e.GithubLogo,{title:"GitHub Environment"}),D(" "+i(e.plan.definition.environment.name),1)])):u("",!0),e.plan.definition.environment.id!==void 0&&e.plan.definition.environment.id!==null?(n(),l("span",be,[o(e.ReliablyLogo,{title:"Reliably Environment"}),t("a",{href:`/environments/view/?id=${e.plan.definition.environment.id}`},i(e.env?.name),9,we)])):u("",!0)],64)):u("",!0)]),t("div",Pe,[e.plan.definition.deployment.deployment_type==="github"?(n(),l("span",De,[o(e.GithubLogo),t("a",{href:`/deployments/view/?id=${e.plan.definition.deployment.deployment_id}`},i(e.dep),9,Le)])):e.plan.definition.deployment.deployment_type==="reliably_cloud"?(n(),l("span",xe,[o(e.ReliablyLogo),t("a",{href:`/deployments/view/?id=${e.plan.definition.deployment.deployment_id}`},i(e.dep),9,ke)])):e.plan.definition.deployment.deployment_type==="reliably_cli"?(n(),l("span",Re,[o(e.ReliablyLogo),t("a",{href:`/deployments/view/?id=${e.plan.definition.deployment.deployment_id}`},i(e.dep),9,Se)])):e.plan.definition.deployment.deployment_type==="container"?(n(),l("span",Ce,[o(e.DockerLogo),t("a",{href:`/deployments/view/?id=${e.plan.definition.deployment.deployment_id}`},i(e.dep),9,Ne)])):e.plan.definition.deployment.deployment_type==="k8s_job"?(n(),l("span",Ee,[o(e.KubernetesLogo),t("a",{href:`/deployments/view/?id=${e.plan.definition.deployment.deployment_id}`},i(e.dep),9,Me)])):(n(),l("span",Be,[t("a",{href:`/deployments/view/?id=${e.plan.definition.deployment.deployment_id}`},i(e.dep),9,Ge)]))]),t("div",je,i(e.plan.executions_count?e.plan.executions_count.toString():"-"),1),t("div",ze,[t("span",null,i(e.lastRun[0]),1),e.lastRun[1]!==""&&e.browserZone!==""?(n(),l("span",{key:0,title:`Displayed for timezone ${e.browserZone}`},i(e.lastRun[1]),9,Ze)):e.lastRun[1]!==""?(n(),l("span",Ke,i(e.lastRun[1]),1)):u("",!0)]),t("div",Te,[t("span",null,i(e.nextRun[0]),1),e.nextRun[1]!==""&&e.browserZone!==""?(n(),l("span",{key:0,title:`Displayed for timezone ${e.browserZone}`},i(e.nextRun[1]),9,Ue)):e.nextRun[1]!==""?(n(),l("span",Ve,i(e.nextRun[1]),1)):u("",!0)]),t("div",Ie,[e.plan.definition.schedule.type==="now"?(n(),l("span",Oe," Once ")):u("",!0),e.plan.definition.schedule.type==="cron"?(n(),l("span",Ae," Periodic ")):u("",!0)]),t("div",Fe,[o(e.DeleteButton,{onClick:V(e.displayDelete,["prevent"])})]),e.isDeleteDisplayed?(n(),te(e.ModalWindow,{key:0,hasCloseButton:!0,hasPadding:!0,onClose:e.closeDelete},{title:j(()=>s[1]||(s[1]=[D("Delete Experiment")])),content:j(()=>[o(e.ConfirmDeletePlan,{id:e.plan.id,"in-place":!0,store:e.store,page:e.page,onClose:e.closeDelete},null,8,["id","store","page"])]),_:1})):u("",!0)])}const dt=z(_e,[["render",He],["__scopeId","data-v-ed9b8d08"]]);export{dt as P};
