import{h as l}from"./user.BEEfOshe.js";import{o as $,m as y}from"./user.Bg1Nd46A.js";import{i as c,d as r}from"./loader.BQDlK3Tc.js";import{a as i}from"./notifications.NSMm1_5U.js";import{u as E}from"./index.CwJxcYEt.js";import{a as h}from"./index.BSdFiPHn.js";const v={ASSETS_PREFIX:void 0,BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,PUBLIC_API_URL:"/api",SITE:void 0,SSR:!1},p=v===void 0?"https://62ff903e9350a1e548e1952e.mockapi.io/api":"/api",g=p==="https://62ff903e9350a1e548e1952e.mockapi.io/api",x=g?"&limit=10":"",j=g?"catalogs-labels":"catalogs/labels",o=E($),m=y({page:0,templates:[],total:0,isReady:!1});async function w(s){return m.set(s),m.get()}const C=async s=>{c();const a=`${p}/organization/${o.value}/catalogs?page=${s}${x}`;try{const e=await fetch(a);if(e.status===403)l(o.value);else if(e.ok){const t=await e.json();let n={page:s,templates:t.items,total:t.count,isReady:!0};w(n)}else throw new Error(e.statusText)}catch(e){const t={title:"Templates couldn't be fetched",message:e.message,type:"error"};i(t)}finally{r()}},D=async s=>{c();const a=s.join("&labels="),e=`${p}/organization/${o.value}/catalogs/by/labels?labels=${a}`;try{const t=await fetch(e);if(t.status===403)l(o.value);else if(t.ok){let b={page:1,templates:await t.json(),total:1,isReady:!0};w(b)}else throw new Error(t.statusText)}catch(t){const n={title:"Templates couldn't be fetched",message:t.message,type:"error"};i(n)}finally{r()}},f=h(null);async function T(s){return f.set(s),f.get()}const I=async s=>{c();const a=`${p}/organization/${o.value}/catalogs/${s}`;try{const e=await fetch(a);if(e.status===403)l(o.value);else if(e.ok){const t=await e.json();T(t)}else throw new Error(e.statusText)}catch(e){const t={title:"Template couldn't be fetched",message:e.message,type:"error"};i(t)}finally{r()}},O=async s=>{c();const a=`/templates/experiments/${s}.json`;try{const e=await fetch(a);if(e.status===403)l(o.value);else if(e.ok){const t=await e.json();T({id:s,manifest:t})}else throw new Error(e.statusText)}catch(e){const t={title:"Template couldn't be fetched",message:e.message,type:"error"};i(t)}finally{r()}},u=y();async function k(s){return u.setKey(s.id,s),u.get()}async function R(){return u.set({}),u.get()}const B=async s=>{c(),R();try{for(const a of s){const e=`/templates/experiments/${a.name}.json`,t=await fetch(e);if(t.status===403)l(o.value);else if(t.ok){const n=await t.json();k({id:a.name,manifest:n})}else throw new Error(t.statusText)}}catch(a){const e={title:"Some related templates couldn't be fetched",message:a.message,type:"error"};i(e)}finally{r()}},M=async s=>{c();const a=`${p}/organization/${o.value}/catalogs`;try{const e=await fetch(a,{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify(s)});if(e.status===403)l(o.value);else if(e.ok){const t=await e.json();window.location.assign(`/experiments/custom-templates/view/?id=${t.id}`)}else throw new Error(e.statusText)}catch(e){const t={title:"Template couldn't be created",message:e.message,type:"error"};i(t)}finally{r()}},N=async s=>{c();let a=!0;const e=`${p}/organization/${o.value}/catalogs/${s}`;try{const t=await fetch(e,{method:"DELETE"});if(t.status===403)l(o.value);else if(!t.ok)throw new Error(t.statusText)}catch(t){const n={title:"Template couldn't be deleted",message:t.message,type:"error"};i(n),a=!1}finally{return r(),a}},d=h(null);async function S(s){return d.set(s),d.get()}const q=async()=>{c();const s=`${p}/organization/${o.value}/${j}`;try{const a=await fetch(s);if(a.status===403)l(o.value);else if(a.ok){const e=await a.json();S(e)}else throw new Error(a.statusText)}catch(a){const e={title:"Labels couldn't be fetched",message:a.message,type:"error"};i(e)}finally{r()}};export{O as a,C as b,M as c,N as d,m as e,I as f,q as g,D as h,B as i,d as l,u as r,f as t};
