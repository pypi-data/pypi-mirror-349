import{w as U}from"./runtime-dom.esm-bundler.DChKj6X8.js";import{m as K,l as Q,c as ee,b as te}from"./series.kU8HocMx.js";import{L as X}from"./LoadingPlaceholder.BoWrztnb.js";import{_ as Y}from"./_plugin-vue_export-helper.DlAUqK2U.js";/* empty css                       */import{C as Z,P as ae,a as se}from"./index.B8cAO9n_.js";import{u as R}from"./index.CwJxcYEt.js";import{d as V,r as o,p as $,o as A,h as n,c as v,i as P,a,n as q,l as T,e as G,F as oe,b as N,g as J}from"./runtime-core.esm-bundler.Y6RLDZTT.js";import{d as I}from"./dayjs.min.xlbmdZiw.js";import{H as re}from"./HelpCircle.XFsukWe6.js";import"./user.Bg1Nd46A.js";import"./index.BSdFiPHn.js";import"./loader.BQDlK3Tc.js";import"./notifications.NSMm1_5U.js";import"./contributions.K_0J8Jft.js";import"./objects.CrQdKsRW.js";import"./user.BEEfOshe.js";/* empty css                       */const ie=V({__name:"MetricsExecutionsPerUser",setup(k,{expose:t}){t();const{Chart:r,Tooltip:e,Legend:s,ArcElement:p,BarElement:c,CategoryScale:m,LinearScale:_}=Z;r.register(e,s,p,c,m,_);const g=o(!0),f=o(!0),d=o(!1),h=R(K),y=o({labels:[],datasets:[{backgroundColor:[],data:[]}]}),D=["#f3a93c","#ee7d56","#de6177","#af588d","#3b4d7c","#3b4d7c","#163e59"];async function x(){await Q()}function S(){f.value=!0,h.value.distributions.per_user.total.length===0?d.value=!1:(d.value=!0,h.value.distributions.per_user.total.forEach((M,u)=>{y.value.labels.push(M.username),y.value.datasets[0].backgroundColor.push(D[u%7]),y.value.datasets[0].data.push(M.count)})),f.value=!1}$(h,()=>S());const B=o({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}}});A(async()=>{g.value=!0,await x(),g.value=!1});const O={Chart:r,Tooltip:e,Legend:s,ArcElement:p,BarElement:c,CategoryScale:m,LinearScale:_,isMounting:g,isComputing:f,hasData:d,storedData:h,pieData:y,COLORS:D,getData:x,computeData:S,pieOptions:B,get Pie(){return ae}};return Object.defineProperty(O,"__isScriptSetup",{enumerable:!1,value:!0}),O}}),ne={class:"metricsExecutionsPerUser"},le={key:0},ce={key:1,class:"metricsExecutionsPerUser__wrapper"};function de(k,t,r,e,s,p){return n(),v("div",ne,[e.hasData?(n(),v("div",ce,[P(e.Pie,{data:e.pieData,options:e.pieOptions},null,8,["data","options"])])):(n(),v("p",le,"We don't have this data yet."))])}const ue=Y(ie,[["render",de],["__scopeId","data-v-116a9861"]]),pe=V({__name:"MetricsExecutionsLastSevenDays",setup(k,{expose:t}){t();const{Chart:r,Tooltip:e,Legend:s,BarElement:p,CategoryScale:c,LinearScale:m}=Z;r.register(e,s,p,c,m);const _=o(!0),g=o(!1),f=o(!1),d=R(K),h=o({labels:[],datasets:[]}),y=o({labels:[],datasets:[]}),D=["#f3a93c","#ee7d56","#de6177","#af588d","#3b4d7c","#3b4d7c","#163e59"];async function x(){await Q()}function S(){if(d.value.distributions.per_user.current_week.length===0)f.value=!1;else{f.value=!0;const u=d.value.distributions.per_user.current_week;let b=[];for(let i=0;i++,i<=7;)b.unshift(I().subtract(i-1,"days").format("ddd MMM D, YYYY"));const l=I().day()+1;h.value.labels=b,y.value.labels=b;let C=0,W=0,w={},E={};u.forEach(i=>{let L=I(i.started_on).day()-l;L<0&&(L=L+7);const j=i.user_id;w[j]||(w[j]={label:i.username,data:[0,0,0,0,0,0,0],backgroundColor:D[C%7]},C++),w[j].data[L]++;const H=i.plan_id;E[H]||(E[H]={label:i.plan_title,data:[0,0,0,0,0,0,0],backgroundColor:D[W%7]},W++),E[H].data[L]++}),Object.keys(w).forEach(i=>{h.value.datasets.push(w[i])}),Object.keys(E).forEach(i=>{y.value.datasets.push(E[i])})}}$(d,()=>S());const B=o("user");function O(u){B.value=u}const F=o({responsive:!0,maintainAspectRatio:!1,scales:{x:{stacked:!0,ticks:{callback:function(u){const b=this.getLabelForValue(u);return I(b).format("dd")[0]}}},y:{stacked:!0,ticks:{stepSize:1}}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(u){let b=[];const z=u.dataset.label.split(" ");let l="";return z.forEach(C=>{l.length+C.length<40?l=`${l} ${C}`:(b.push(l),l="",l=C)}),l=`${l}: ${u.dataset.data[u.dataIndex]}`,b.push(l),l="",b}}}}});A(async()=>{_.value=!0,await x(),_.value=!1});const M={Chart:r,Tooltip:e,Legend:s,BarElement:p,CategoryScale:c,LinearScale:m,isMounting:_,isComputing:g,hasData:f,storedData:d,userData:h,planData:y,COLORS:D,getData:x,computeData:S,displayedChart:B,display:O,chartOptions:F,get Bar(){return se},LoadingPlaceholder:X};return Object.defineProperty(M,"__isScriptSetup",{enumerable:!1,value:!0}),M}}),me={class:"metricsExecutionsLastSevenDays"},_e={class:"metricsExecutionsLastSevenDays__controls"},fe={key:1},he={key:2,class:"metricsExecutionsLastSevenDays__wrapper"};function be(k,t,r,e,s,p){return n(),v("div",me,[a("div",_e,[a("button",{onClick:t[0]||(t[0]=U(c=>e.display("user"),["prevent"])),class:q(["pill",{"pill--active":e.displayedChart==="user"}])}," Per user ",2),a("button",{onClick:t[1]||(t[1]=U(c=>e.display("plan"),["prevent"])),class:q(["pill",{"pill--active":e.displayedChart==="plan"}])}," Per plan ",2)]),e.isMounting||e.isComputing?(n(),T(e.LoadingPlaceholder,{key:0})):e.hasData?(n(),v("div",he,[e.displayedChart==="user"?(n(),T(e.Bar,{key:0,data:e.userData,options:e.chartOptions},null,8,["data","options"])):G("",!0),e.displayedChart==="plan"?(n(),T(e.Bar,{key:1,data:e.planData,options:e.chartOptions},null,8,["data","options"])):G("",!0)])):(n(),v("p",fe,"We don't have this data yet."))])}const ve=Y(pe,[["render",be],["__scopeId","data-v-a4eed697"]]),ge=V({__name:"DashboardStartNow",setup(k,{expose:t}){t();const r=o(!0),e=J(()=>s.value.datasets.length>0),s=R(ee),p=J(()=>r.value||s.value.state==="empty"||s.value.state==="loading"),c=o(!1),m=o({labels:[],datasets:[{label:"Contributions",backgroundColor:"hsla(329,97%,55%,0.2)",borderColor:"hsl(329,97%,55%)",pointBackgroundColor:"hsl(329,97%,55%)",pointBorderColor:"white",pointHoverBackgroundColor:"white",pointHoverBorderColor:"hsl(329,97%,55%)",data:[]}]});async function _(){await te(),e.value&&(m.value.labels=[...s.value.labels],m.value.datasets[0].data=[...s.value.datasets[0].data])}function g(){localStorage.getItem("reliably:isStartMessageDismissed")==="true"&&(c.value=!0)}function f(){localStorage.setItem("reliably:isStartMessageDismissed","true"),c.value=!0}A(async()=>{r.value=!0,g(),await _(),r.value=!1});const d={isMounting:r,hasData:e,storedData:s,isLoading:p,isMessageDismissed:c,chartData:m,getData:_,getMessageStatus:g,dismissMessage:f,LoadingPlaceholder:X,MetricsExecutionsPerUser:ue,MetricsExecutionsLastSevenDays:ve,HelpCircle:re};return Object.defineProperty(d,"__isScriptSetup",{enumerable:!1,value:!0}),d}}),ye={class:"dashboardStartNow"},De={class:"dashboardItem"},Ce={class:"hasTooltip hasTooltip--bottom-right","aria-label":"All time executions, distributed by users"},ke={class:"dashboardItem"},xe={class:"hasTooltip hasTooltip--bottom-right","aria-label":"Executions distribution during the last 7 days"},Se={key:2,class:"dashboardStartNow__message"},Me={class:"dashboardStartNow__actions"};function we(k,t,r,e,s,p){return n(),v("div",ye,[e.isLoading?(n(),T(e.LoadingPlaceholder,{key:0,size:"fill"})):e.hasData||e.isMessageDismissed?(n(),v(oe,{key:1},[a("section",De,[a("h2",null,[t[0]||(t[0]=N(" Executions per user ")),a("span",Ce,[P(e.HelpCircle)])]),P(e.MetricsExecutionsPerUser,{"client:load":""})]),a("section",ke,[a("h2",null,[t[1]||(t[1]=N(" Last 7 days ")),a("span",xe,[P(e.HelpCircle)])]),P(e.MetricsExecutionsLastSevenDays,{"client:load":""})])],64)):(n(),v("div",Se,[t[3]||(t[3]=a("h2",null,"Welcome!",-1)),t[4]||(t[4]=a("p",{class:"text-center"},"You don't have any experiments yet.",-1)),t[5]||(t[5]=a("p",{class:"text-center"},[N(" You can "),a("a",{href:"/experiments/new/"},"upload an existing Chaos Toolkit experiment"),a("br"),N(" or get started with one of our 250+ ready-to-run experiments ")],-1)),a("div",Me,[t[2]||(t[2]=a("a",{href:"/experiments/custom-templates/create/?activity=reliably-tls-verify_certificate",class:"button button--primary"},"Let's go",-1)),a("button",{onClick:U(e.dismissMessage,["prevent"]),class:"button button--ghost"}," Dismiss ")])]))])}const qe=Y(ge,[["render",we]]);export{qe as default};
