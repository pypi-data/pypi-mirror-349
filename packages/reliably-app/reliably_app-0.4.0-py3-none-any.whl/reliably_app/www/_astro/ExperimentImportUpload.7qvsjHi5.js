import{l as E}from"./js-yaml.C-pQuU5J.js";import{D as y}from"./DropZone.CliujHPk.js";import{i as C}from"./strings.Fm4VVZpd.js";import{c as F}from"./experiments.rwiqw3d6.js";import{i as I}from"./experiments.E3MiUWYx.js";import{E as J}from"./ExperimentContributions.DYiQPL7e.js";/* empty css                     */import{_ as g}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{d as k,c as N,i as O,m as U,a as c,n as V,l as D,e as w,r as i,g as A,h as b}from"./runtime-core.esm-bundler.Y6RLDZTT.js";import"./runtime-dom.esm-bundler.DChKj6X8.js";/* empty css                     */import"./dayjs.min.xlbmdZiw.js";import"./duration.BGVtNWJ9.js";import"./notifications.NSMm1_5U.js";import"./index.BSdFiPHn.js";import"./objects.CrQdKsRW.js";import"./user.BEEfOshe.js";import"./user.Bg1Nd46A.js";import"./loader.BQDlK3Tc.js";import"./index.CwJxcYEt.js";import"./PlusIcon.CLPjCzPo.js";import"./MinusIcon.BnPCOBQF.js";/* empty css                        */const L=k({__name:"ExperimentImportUpload",setup(h,{expose:n}){n();const r=i("No file selected"),e=i(""),s=i(""),o=i(null),t=i(!1),a=i(!1),u=i(""),d=i(!1),_=i({availability:"none",latency:"none",security:"none",performance:"none"}),S=A(()=>({"experimentImportUpload__info--error":e.value!==""&&(!t.value||!a.value),"experimentImportUpload__info--ok":e.value!==""&&t&&a.value})),x={message:r,rawInput:e,inputType:s,experimentJson:o,isFileReadable:t,isFileValidExperiment:a,dropZoneStatus:u,areContributionsDisplayed:d,contributions:_,messageClassObject:S,handleExperimentFile:m=>{s.value="";let l=null;if(m.items){let p=m.items[0];p.kind==="file"&&(l=p.getAsFile(),r.value=`Selected file: ${l.name}`)}else l=[...m.files][0],r.value=`Selected file: ${l.name}`;if(l!==null){u.value="has-file";var f=new FileReader;f.onload=function(){let p=f.result;if(p!==null){if(e.value=p,C(e.value))o.value=JSON.parse(e.value),t.value=!0,s.value="JSON";else try{o.value=E(e.value),t.value=!0,s.value="YAML"}catch{t.value=!1,r.value="Input is not valid JSON nor YAML"}if(t.value){let v=F(o.value);v===""?(a.value=!0,(o.contributions===void 0||Object.entries(o.contributions).length===0)&&(d.value=!0)):(a.value=!1,r.value+=` is not a valid Chaos Toolkit experiment: ${v}.`,u.value="has-error")}}else a.value=!1,t.value=!1,r.value+=" is not valid JSON nor YAML",u.value="has-error"},f.readAsText(l)}},importFromJson:async()=>{d.value&&(o.value.contributions=_.value);let m={experiment:JSON.stringify(o.value)};await I(m)},DropZone:y,ExperimentContributions:J};return Object.defineProperty(x,"__isScriptSetup",{enumerable:!1,value:!0}),x}}),M={class:"experimentImportUpload"},T=["innerHTML"],j={class:"experimentImportUpload__submit"},B=["disabled"];function Z(h,n,r,e,s,o){return b(),N("div",M,[O(e.DropZone,{onFilesDropped:e.handleExperimentFile,status:e.dropZoneStatus},{default:U(()=>n[1]||(n[1]=[c("p",null,"Drag and drop an experiment JSON file",-1)])),_:1},8,["status"]),c("p",{class:V(["experimentImportUpload__info",e.messageClassObject]),innerHTML:e.message},null,10,T),e.areContributionsDisplayed?(b(),D(e.ExperimentContributions,{key:0,modelValue:e.contributions,"onUpdate:modelValue":n[0]||(n[0]=t=>e.contributions=t),"import-mode":!0,"form-wrap":!0},null,8,["modelValue"])):w("",!0),c("div",j,[c("button",{onClick:e.importFromJson,class:"button button--primary",disabled:!e.isFileValidExperiment}," Import ",8,B)])])}const de=g(L,[["render",Z],["__scopeId","data-v-af4176e5"]]);export{de as default};
